C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE DECODER
OBJECT MODULE PLACED IN decoder.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Receiver\decoder.c LARGE BROWSE INCDIR(.\Receiver) DEBUG OBJECTEXTEND PRINT
                    -(.\decoder.lst) OBJECT(decoder.obj)

line level    source

   1          #include "decoder.h"
   2          #include "ev1527.h"
   3          #include "usart.h"
   4          #include "at24c256.h"
   5          #include "key.h"
   6          #include "menu.h"
   7          #include "tm1629.h"
   8          #include "timer.h"
   9          #include "gd5800.h"
  10          #include "com.h"
  11          
  12          unsigned char buf_eeprom[8] = { 0 };//–¥»ÎEEPROM_buf
  13          unsigned char Two_menu_set_success = 0;
  14          uint32_t last_dat = 0;
  15          uint8_t  decoder_num = 0;
  16          
  17          void DecoderProcess(void)
  18          {       
  19   1              RF_def tmp;
  20   1              RF_def RFtmp;
  21   1              uint32_t dat;
  22   1              int state = 0;
  23   1              unsigned char i, j ,l ,k ,index=0;
  24   1              unsigned char temp_buff[8];//Ω‚¬Î”√¡Ÿ ± ˝◊È
  25   1      
  26   1              unsigned char func_index_temp = 0;              //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  27   1              unsigned char Two_Menu_F8_E1_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  28   1              unsigned char Two_Menu_F8_E2_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  29   1              unsigned char Two_Menu_F3_E1_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø    
  30   1              unsigned char Two_Menu_F3_E2_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  31   1              unsigned char Two_Menu_F7_E1_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  32   1              unsigned char Two_Menu_F6_E1_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  33   1              unsigned char Two_Menu_F6_E2_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  34   1      
  35   1              func_index_temp = return_func_index();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  36   1              Two_Menu_F8_E1_temp = return_Two_Menu_F8_E1();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  37   1              Two_Menu_F8_E2_temp = return_Two_Menu_F8_E2();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  38   1              Two_Menu_F3_E1_temp = return_Two_Menu_F3_E1();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  39   1              Two_Menu_F3_E2_temp = return_Two_Menu_F3_E2();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  40   1              index                       = return_Two_Menu_F3_E2();
  41   1              Two_Menu_F7_E1_temp = return_Two_Menu_F7_E1();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  42   1              Two_Menu_F6_E1_temp = return_Two_Menu_F6_E1();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  43   1              Two_Menu_F6_E2_temp = return_Two_Menu_F6_E2();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  44   1      
  45   1              receive_rf_decoder();   //Ω‚¬Î∫Ø ˝
  46   1      
  47   1              if (return_again_receive_rf_decoder_finished() == 1) //±Í÷æŒªµ»”⁄1 Àµ√˜‘⁄2¥ŒºÏ—Èœ¬Õ®π˝,Ω” ’µΩ”––ß¬Î
  48   1              {
  49   2      #ifdef DEBUG1
                              uart_printf("decoder_val is %02x %02x %02x .\r\n", (unsigned int)old2_RF_RECE_REG[0], (unsigned int)old2
             -_RF_RECE_REG[1], (unsigned int)old2_RF_RECE_REG[2]); //≤‚ ‘∞¥º¸º¸÷µ
              #endif
  52   2                      dat = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32_t)old2_RF_
             -RECE_REG[2]);
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 2   

  53   2                      switch (func_index_temp)
  54   2                      {
  55   3                      case MENU_STANDBY://¥˝ª˙◊¥Ã¨œ¬
  56   3                      {
  57   4                              set_logout_cycle_table(0);//—≠ª∑∏˙œ˙∫≈÷ÿ–¬º∆ ˝
  58   4                              //º¸≈ÃπÊ‘Ú
  59   4                              if ((old2_RF_RECE_REG[2] & 0xf0) == 0x00 && ((old2_RF_RECE_REG[0] >> 4) == Two_Menu_F7_E1_temp) && (old
             -2_RF_RECE_REG[0] >> 4) < 10)//º¸≈ÃπÊ‘Ú£¨≥Ã–Ú∞¥ƒ¨»œµƒ¿¥±‡
  60   4                              {
  61   5                                      if (Two_Menu_F8_E1_temp == 1)  //Œ™∞¥º¸÷µ
  62   5                                      {
  63   6                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f] ;
  64   6                                      }
  65   5                                      else
  66   5                                      {
  67   6                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
  68   6                                      }   
  69   5                                      temp_buff[1] = old2_RF_RECE_REG[0] >> 4;        //Œ™∑¿«¯∫≈
  70   5                                      temp_buff[2] = old2_RF_RECE_REG[0] & 0x0f;      //Œ™3Œª◊È¬Îµ⁄“ªŒª
  71   5                                      temp_buff[3] = old2_RF_RECE_REG[1] >> 4;        //Œ™3Œª◊È¬Îµ⁄∂˛Œª
  72   5                                      temp_buff[4] = old2_RF_RECE_REG[1] & 0x0f;      //Œ™3Œª◊È¬Îµ⁄»˝Œª
  73   5                                      temp_buff[5] = old2_RF_RECE_REG[0];                     //±∏”√œÓ,‘›«“¥Êµ⁄1ŒªID¬Î
  74   5                                      temp_buff[6] = old2_RF_RECE_REG[1];                     //±∏”√œÓ,‘›«“¥Êµ⁄2ŒªID¬Î
  75   5                                      temp_buff[7] = old2_RF_RECE_REG[2];                     //±∏”√œÓ,‘›«“¥Êµ⁄3ŒªID¬Î
  76   5      
  77   5                                      if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
  78   5                                      {
  79   6                                              for (l = 0; l < Two_Menu_F6_E2_temp; l++)
  80   6                                              {
  81   7                                                      submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
  82   7                                              }
  83   6                                      }
  84   5                                      else
  85   5                                      {
  86   6                                              Cancel_funtion(temp_buff,display_ram);//»°œ˚∫Ø ˝
  87   6                                              mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
  88   6                                              tm1629_load();
  89   6                                              display();
  90   6                                              break;
  91   6                                      }               
  92   5                                      if (decoder_num < Two_Menu_F3_E2_temp)
  93   5                                              decoder_num++;
  94   5                                      tm1629_clear();//«Â∆¡
  95   5                                      mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
  96   5                                      decoder_temp_to_mcuram(display_ram, temp_buff);//Ω´¡Ÿ ± ˝◊Èµƒ ˝æ›“∆»Îµ•∆¨ª˙‘›¥Ê ˝◊È 8◊÷Ω⁄◊™6◊÷Ω⁄
  97   5                                      tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
  98   5                                      display();//œ‘ æ ˝¬Îπ‹
  99   5                                      set_func_index(DECODER_MENU);//¥À ±Ã¯»ÎΩ‚¬Î≤Àµ•£¨Œ™œ¬“ª¥ŒΩ‚¬Î◊ˆ◊º±∏
 100   5                                      //clear_again_receive_rf_decoder_finished();//«Â≥˝Ω‚¬ÎÕÍ≥…±Í÷æŒª
 101   5      
 102   5                                      break;
 103   5                              }
 104   4                              //∫ÙΩ–∆˜◊¢≤·,À—À˜À˘–Ë“™µƒ∫ÙΩ–∆˜
 105   4      #ifdef DEBUG
                                      uart_printf("dat is : %x %x \r\n", (unsigned int)(dat >> 16), (unsigned int)dat);
              #endif
 108   4                              if (state = Find_RF_EEPROM(&RFtmp, dat))
 109   4                              {
 110   5                                      if (last_dat == dat)
 111   5                                      {
 112   6                                              if (return_second_filter_table() != 0)
 113   6                                              {
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 3   

 114   7                                                      goto standby;
 115   7                                              }
 116   6                                      
 117   6                                      }
 118   5                                      else
 119   5                                      {
 120   6                                              last_dat = dat;
 121   6                                              clear_second_filter_time();
 122   6                                              set_second_filter_table(1);
 123   6                                      }
 124   5      
 125   5      #ifdef DEBUG
                                              uart_printf("Find_RF_EEPROM \r\n");
                                              uart_printf("state is : %x \r\n", (unsigned int)state);
              #endif
 129   5                                      if (state == 1)
 130   5                                      {
 131   6                                              temp_buff[0] = QUXIAO_1;
 132   6                                      }
 133   5                                      else if (state == 2)
 134   5                                      {
 135   6                                              temp_buff[0] = BAOJING_1;
 136   6                                      }
 137   5                                      else
 138   5                                      {
 139   6                                              temp_buff[0] = old2_RF_RECE_REG[2] & 0x0f;
 140   6                                      }
 141   5      
 142   5      #ifdef DEBUG
                                              uart_printf("temp[0] is : %x \r\n", (unsigned int)temp_buff[0]);
              #endif
 145   5                                      memcpy(temp_buff+1, RFtmp.region, 4);
 146   5                                      temp_buff[7] = old2_RF_RECE_REG[2];
 147   5      
 148   5                                      if (temp_buff[0] < 50)
 149   5                                      {
 150   6      #ifdef DEBUG
                                                      uart_printf("temp_buff[0] < 50 \r\n");
              #endif
 153   6                                              if (Two_Menu_F8_E1_temp == 1)  //Œ™∞¥º¸÷µ
 154   6                                              {
 155   7      
 156   7                                                      temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 157   7                                              }
 158   6                                              else
 159   6                                              {
 160   7      
 161   7                                                      temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 162   7                                              }
 163   6                                      }
 164   5      
 165   5      #ifdef DEBUG
                                              uart_printf("temp[0] is : %x \r\n", (unsigned int)temp_buff[0]);
              #endif
 168   5      
 169   5      
 170   5      #ifdef DEBUG
                                              uart_printf("cancen funtion \r\n");
              #endif
 173   5                                      //”Ô“Ù∫Ø ˝
 174   5                                      if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 175   5                                      {
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 4   

 176   6      #ifdef DEBUG
                                                      uart_printf("cancen funtion fault \r\n");
              #endif
 179   6                                              for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 180   6                                              {
 181   7                                                      submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 182   7                                              }
 183   6                                      }
 184   5                                      else
 185   5                                      {
 186   6      #ifdef DEBUG
                                                      uart_printf("cancen funtion success \r\n");
              #endif
 189   6                                              if (decoder_num < Two_Menu_F3_E2_temp)
 190   6                                                      decoder_num++;
 191   6                                              mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 192   6                                              Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 193   6                                              tm1629_load();
 194   6                                              display();
 195   6                                              goto standby;
 196   6                                      }
 197   5      
 198   5                                      tm1629_clear();//«Â∆¡
 199   5                                      mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 200   5                                      decoder_temp_to_mcuram(display_ram, temp_buff);//»Áπ˚∑˚∫œµƒª∞  Ω´¡Ÿ ± ˝◊Èµƒ ˝æ›“∆»Îµ•∆¨ª˙‘›¥Ê ˝◊È 8◊÷Ω
             -⁄◊™6◊÷Ω⁄
 201   5                                      tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 202   5                                      display();//œ‘ æ ˝¬Îπ‹
 203   5      #ifdef DEBUG
                                              uart_printf("decoder success!");
              #endif
 206   5      
 207   5                                      set_func_index(DECODER_MENU);;//¥À ±Ã¯»ÎΩ‚¬Î≤Àµ•£¨Œ™œ¬“ª¥ŒΩ‚¬Î◊ˆ◊º±∏
 208   5                                      clear_again_receive_rf_decoder_finished();//«Â≥˝Ω‚¬ÎÕÍ≥…±Í÷æŒª
 209   5                                      goto standby;
 210   5      
 211   5                              }
 212   4      standby:
 213   4                               break;
 214   4                      }
 215   3      
 216   3                      case DECODER_MENU: //Ω‚¬Î≤Àµ•œ¬
 217   3                      {
 218   4                              set_logout_cycle_table(0);//—≠ª∑∏˙œ˙∫≈÷ÿ–¬º∆ ˝
 219   4                               //º¸≈ÃπÊ‘Ú
 220   4                              if ((old2_RF_RECE_REG[2] & 0xf0) == 0x00 && ((old2_RF_RECE_REG[0] >> 4) == Two_Menu_F7_E1_temp) && (old
             -2_RF_RECE_REG[0] >> 4) < 10)//º¸≈ÃπÊ‘Ú£¨≥Ã–Ú∞¥ƒ¨»œµƒ¿¥±‡
 221   4                              {
 222   5                                      if (Two_Menu_F8_E1_temp == 1)  //Œ™∞¥º¸÷µ
 223   5                                      {
 224   6                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 225   6                                      }
 226   5                                      else
 227   5                                      {
 228   6                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 229   6                                      }
 230   5                                      temp_buff[1] = old2_RF_RECE_REG[0] >> 4;        //Œ™∑¿«¯∫≈
 231   5                                      temp_buff[2] = old2_RF_RECE_REG[0] & 0x0f;      //Œ™3Œª◊È¬Îµ⁄“ªŒª
 232   5                                      temp_buff[3] = old2_RF_RECE_REG[1] >> 4;        //Œ™3Œª◊È¬Îµ⁄∂˛Œª
 233   5                                      temp_buff[4] = old2_RF_RECE_REG[1] & 0x0f;      //Œ™3Œª◊È¬Îµ⁄»˝Œª
 234   5                                      temp_buff[5] = old2_RF_RECE_REG[0];                     //±∏”√œÓ,‘›«“¥Êµ⁄“ªŒªID¬Î
 235   5                                      temp_buff[6] = old2_RF_RECE_REG[1];                     //±∏”√œÓ,‘›«“¥Êµ⁄∂˛ŒªID¬Î
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 5   

 236   5                                      temp_buff[7] = old2_RF_RECE_REG[2];                     //±∏”√œÓ,‘›«“¥Êµ⁄»˝ŒªID¬Î
 237   5                                      if (Two_Menu_F3_E1_temp == 1)                           //Œ™º¥ ±ƒ£ Ω
 238   5                                      {       
 239   6                                              if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 240   6                                              {
 241   7                                                      for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 242   7                                                      {
 243   8                                                              submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 244   8                                                      }
 245   7                                              }
 246   6                                              else
 247   6                                              {
 248   7                                                      mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 249   7                                                      Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 250   7                                                      tm1629_load();
 251   7                                                      display();
 252   7                                                      break;
 253   7                                              }
 254   6                                              if (decoder_num < Two_Menu_F3_E2_temp)
 255   6                                                      decoder_num++;
 256   6                                              mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 257   6                                              Search_funtion(temp_buff, display_ram);
 258   6      
 259   6                                              for (l = Two_Menu_F3_E2_temp; l>1; l--) //’˚ÃÂÕ˘œ¬“∆“ª◊È ˝æ›
 260   6                                              {
 261   7                                                      mcuram_to_mcuram_down(display_ram + ((l - 2)<<3));
 262   7                                              }
 263   6                                              for (l = 0; l<6; l++) //Ω≤µ⁄“ª◊È ˝æ›«Â0
 264   6                                              {
 265   7                                                      display_ram[l] = 0;
 266   7                                              }
 267   6                                                      
 268   6                                              decoder_temp_to_mcuram(display_ram, temp_buff); //»Áπ˚∑˚∫œµƒª∞  Ω´¡Ÿ ± ˝◊Èµƒ ˝æ›“∆»Îµ•∆¨ª˙‘›¥Ê ˝◊È 8◊
             -÷Ω⁄◊™6◊÷Ω⁄                        
 269   6                                              tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 270   6                                              display();//œ‘ æ ˝¬Îπ‹
 271   6                                      }
 272   5                                      else if (Two_Menu_F3_E1_temp == 2)//Œ™—≠ª∑ƒ£ Ω
 273   5                                      {
 274   6                                              if (temp_buff[0] == QUXIAO_1 || temp_buff[0] == 0)
 275   6                                              {
 276   7                                                      mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 277   7                                                      Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 278   7                                                      tm1629_load();
 279   7                                                      display();
 280   7                                                      break;
 281   7                                              }
 282   6                                              for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 283   6                                              {
 284   7                                                      if (display_ram[(k << 3) + 1] == temp_buff[1] && display_ram[(k << 3) + 2] == temp_buff[2] && displa
             -y_ram[(k << 3) + 3] == temp_buff[3] && display_ram[(k << 3) + 4] == temp_buff[4])
 285   7                                                      {
 286   8                                                              index = k;
 287   8                                                              decoder_temp_to_mcuram(display_ram + (k << 3), temp_buff);
 288   8                                                              tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 289   8                                                              display();//œ‘ æ ˝¬Îπ‹
 290   8                                                              break;
 291   8                                                      }
 292   7                                              }
 293   6      
 294   6                                              if (index == Two_Menu_F3_E2_temp)
 295   6                                              {
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 6   

 296   7                                                      for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 297   7                                                      {
 298   8                                                              if (display_ram[(k << 3)] == 0)//’“≥ˆŒª”⁄∂”¡–◊Ó∫Ûµƒƒ«∏ˆµ„
 299   8                                                              {
 300   9                                                                      if (decoder_num < Two_Menu_F3_E2_temp)
 301   9                                                                              decoder_num++;
 302   9                                                                      mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 303   9                                                                      decoder_temp_to_mcuram(display_ram + (k << 3), temp_buff);
 304   9                                                                      tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 305   9                                                                      display();//œ‘ æ ˝¬Îπ‹
 306   9                                                                      break;
 307   9      
 308   9                                                              }
 309   8                                                      }
 310   7                                              }
 311   6                                      }
 312   5                                      //clear_again_receive_rf_decoder_finished();//«Â≥˝Ω‚¬ÎÕÍ≥…±Í÷æŒª
 313   5                                      break;
 314   5                              }
 315   4                              //∫ÙΩ–∆˜◊¢≤·,À—À˜À˘–Ë“™µƒ∫ÙΩ–∆˜
 316   4                              if (state = Find_RF_EEPROM(&RFtmp, dat))
 317   4                              {
 318   5                                      if (last_dat == dat)
 319   5                                      {
 320   6                                              if (return_second_filter_table() != 0)
 321   6                                              {
 322   7                                                      goto decoder;
 323   7                                              }
 324   6      
 325   6                                      }
 326   5                                      else
 327   5                                      {
 328   6                                              last_dat = dat;
 329   6                                              clear_second_filter_time();
 330   6                                              set_second_filter_table(1);
 331   6                                      }
 332   5      #ifdef DEBUG
                                              uart_printf("Find_RF_EEPROM \r\n");
              #endif
 335   5                                      if (state == 1)
 336   5                                      {
 337   6                                              temp_buff[0] = QUXIAO_1;
 338   6                                      }
 339   5                                      else if (state == 2)
 340   5                                      {
 341   6                                              temp_buff[0] = BAOJING_1;
 342   6                                      }
 343   5                                      else
 344   5                                      {
 345   6                                              temp_buff[0] = old2_RF_RECE_REG[2] & 0x0f;
 346   6                                      }
 347   5      
 348   5                                      memcpy(temp_buff + 1, RFtmp.region, 4);
 349   5                                      temp_buff[7] = old2_RF_RECE_REG[2];
 350   5      
 351   5                                      if (temp_buff[0] < 50)
 352   5                                      {
 353   6                                              if (Two_Menu_F8_E1_temp == 1)  //Œ™∞¥º¸÷µ
 354   6                                              {
 355   7      
 356   7                                                      temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 357   7                                              }
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 7   

 358   6                                              else
 359   6                                              {
 360   7      
 361   7                                                      temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 362   7                                              }
 363   6                                      }
 364   5      
 365   5                                      if (Two_Menu_F3_E1_temp == 1)//Œ™º¥ ±ƒ£ Ω
 366   5                                      {
 367   6      
 368   6                                              if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 369   6                                              {
 370   7      #ifdef DEBUG
                                                              uart_printf("cancen funtion fault \r\n");
              #endif
 373   7                                                      for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 374   7                                                      {
 375   8                                                              submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 376   8                                                      }
 377   7                                              }
 378   6                                              else
 379   6                                              {
 380   7      #ifdef DEBUG
                                                              uart_printf("cancen funtion success \r\n");
              #endif
 383   7                                                      mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 384   7                                                      Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 385   7                                                      tm1629_load();
 386   7                                                      display();
 387   7                                                      goto decoder;
 388   7                                              }
 389   6                                              if (decoder_num < Two_Menu_F3_E2_temp)
 390   6                                                      decoder_num++;
 391   6                                              mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 392   6                                              Search_funtion(temp_buff, display_ram);
 393   6      
 394   6                                              for (l = Two_Menu_F3_E2_temp; l > 1; l--) //’˚ÃÂÕ˘œ¬“∆“ª◊È ˝æ›
 395   6                                              {
 396   7                                                      mcuram_to_mcuram_down(display_ram + ((l - 2) << 3));
 397   7                                              }
 398   6                                              for (l = 0; l < 6; l++) //Ω≤µ⁄“ª◊È ˝æ›«Â0
 399   6                                              {
 400   7                                                      display_ram[l] = 0;
 401   7                                              }
 402   6      
 403   6                                              decoder_temp_to_mcuram(display_ram, temp_buff); //»Áπ˚∑˚∫œµƒª∞  Ω´¡Ÿ ± ˝◊Èµƒ ˝æ›“∆»Îµ•∆¨ª˙‘›¥Ê ˝◊È 8◊
             -÷Ω⁄◊™6◊÷Ω⁄
 404   6                                              tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 405   6                                              display();//œ‘ æ ˝¬Îπ‹
 406   6                                      }
 407   5                                      else if (Two_Menu_F3_E1_temp == 2)//Œ™—≠ª∑ƒ£ Ω
 408   5                                      {
 409   6                                              if (temp_buff[0] == QUXIAO_1 || temp_buff[0] == 0)
 410   6                                              {
 411   7                                                      mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 412   7                                                      Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 413   7                                                      tm1629_load();
 414   7                                                      display();
 415   7                                                      break;
 416   7                                              }
 417   6      
 418   6                                              for (k = 0; k < Two_Menu_F3_E2_temp; k++)
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 8   

 419   6                                              {
 420   7                                                      if (display_ram[(k << 3) + 1] == temp_buff[1] && display_ram[(k << 3) + 2] == temp_buff[2] && displa
             -y_ram[(k << 3) + 3] == temp_buff[3] && display_ram[(k << 3) + 4] == temp_buff[4])
 421   7                                                      {
 422   8                                                              index = k;
 423   8                                                              decoder_temp_to_mcuram(display_ram + (k << 3), temp_buff);
 424   8                                                              tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 425   8                                                              display();//œ‘ æ ˝¬Îπ‹
 426   8                                                              break;
 427   8                                                      }
 428   7                                              }
 429   6      
 430   6                                              if (index == Two_Menu_F3_E2_temp)
 431   6                                              {
 432   7                                                      for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 433   7                                                      {
 434   8                                                              if (display_ram[(k << 3)] == 0)//’“≥ˆŒª”⁄∂”¡–◊Ó∫Ûµƒƒ«∏ˆµ„
 435   8                                                              {
 436   9                                                                      if (decoder_num < Two_Menu_F3_E2_temp)
 437   9                                                                              decoder_num++;
 438   9                                                                      mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 439   9                                                                      decoder_temp_to_mcuram(display_ram + (k << 3), temp_buff);
 440   9                                                                      tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 441   9                                                                      display();//œ‘ æ ˝¬Îπ‹
 442   9                                                                      break;
 443   9      
 444   9                                                              }
 445   8                                                      }
 446   7                                              }
 447   6                                      }
 448   5      #ifdef DEBUG
                                              uart_printf("decoder success!");
              #endif
 451   5                                      clear_again_receive_rf_decoder_finished();
 452   5                                      goto decoder;
 453   5      
 454   5                              }
 455   4                                      
 456   4                              
 457   4      decoder:
 458   4                              break;
 459   4                      }
 460   3      
 461   3                      case TWO_MENU_F1_E1_D1:
 462   3                      case TWO_MENU_F1_E1_D2:
 463   3                      case TWO_MENU_F1_E1_D3:
 464   3                      case TWO_MENU_F1_E1_D4:
 465   3                      {
 466   4                              set_func_index(TWO_MENU_F1_E1_D4);
 467   4      
 468   4                              memcpy(tmp.region, Two_Menu_F1_E1, 4);
 469   4                              tmp.rf = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32_t)old2
             -_RF_RECE_REG[2]);
 470   4                              if (!(register_call_function(&tmp)))// ˝÷µ◊‘∂Øº”1
 471   4                              {
 472   5      #ifdef DEBUG
                                              uart_printf("dat is : %x %x \r\n", (unsigned int)(tmp.rf >> 16), (unsigned int)tmp.rf);
                                              uart_printf("call is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E1[0], (unsigned int)Two_Men
             -u_F1_E1[1], (unsigned int)Two_Menu_F1_E1[2], (unsigned int)Two_Menu_F1_E1[3]);
                                              uart_printf("caller is rigister success \r\n");
              #endif                                  
 477   5                                      delay10ms();
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 9   

 478   5                                      if (Two_Menu_F1_E1[3] == 9)
 479   5                                      {
 480   6                                              if (Two_Menu_F1_E1[2] == 9)
 481   6                                              {
 482   7                                                      if (Two_Menu_F1_E1[1] == 9)
 483   7                                                      {
 484   8                                                              Two_Menu_F1_E1[0]++;
 485   8                                                              Two_Menu_F1_E1[1] = 0;
 486   8                                                              Two_Menu_F1_E1[2] = 0;
 487   8                                                              if (Two_Menu_F1_E1[0] == 21)
 488   8                                                              {
 489   9                                                                      Two_Menu_F1_E1[0] = 0;
 490   9                                                                      Two_Menu_F1_E1[3] = 1;
 491   9                                                              }
 492   8                                                              else
 493   8                                                              {
 494   9                                                                      Two_Menu_F1_E1[3] = 1;
 495   9                                                              }
 496   8                                                      }
 497   7                                                      else
 498   7                                                      {
 499   8                                                              Two_Menu_F1_E1[1]++;
 500   8                                                              Two_Menu_F1_E1[2] = 0;
 501   8                                                              Two_Menu_F1_E1[3] = 0;
 502   8                                                      }
 503   7                                              }
 504   6                                              else
 505   6                                              {
 506   7                                                      Two_Menu_F1_E1[2]++;
 507   7                                                      Two_Menu_F1_E1[3] = 0;
 508   7                                              }
 509   6                                      }
 510   5                                      else
 511   5                                              Two_Menu_F1_E1[3]++;
 512   5                              }
 513   4                              break;
 514   4                      }
 515   3      
 516   3                      case TWO_MENU_F1_E2_D1:
 517   3                      case TWO_MENU_F1_E2_D2:
 518   3                      case TWO_MENU_F1_E2_D3:
 519   3                      case TWO_MENU_F1_E2_D4:
 520   3                      {
 521   4                                                                        set_func_index(TWO_MENU_F1_E2_D4);
 522   4                                                                        memcpy(tmp.region, Two_Menu_F1_E2, 4);
 523   4                                                                        tmp.rf = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32
             -_t)old2_RF_RECE_REG[2]);
 524   4      
 525   4                                                                        if (!register_host_function(&tmp))// ˝÷µ◊‘∂Øº”1
 526   4                                                                        {
 527   5      #ifdef DEBUG
                                                                                        uart_printf("host is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eepr
             -om[6], (unsigned int)buf_eeprom[7]); //≤‚ ‘∞¥º¸º¸÷µ
                                                                                        uart_printf("host is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E2[0], (unsigned int)
             -Two_Menu_F1_E2[1], (unsigned int)Two_Menu_F1_E2[2], (unsigned int)Two_Menu_F1_E2[3]);
                                                                                        uart_printf("host is rigister success \r\n");
              #endif                                  
 532   5                                                                                delay10ms();
 533   5                                                                                if (Two_Menu_F1_E2[3] == 9)
 534   5                                                                                {
 535   6                                                                                        if (Two_Menu_F1_E2[2] == 9)
 536   6                                                                                        {
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 10  

 537   7                                                                                                if (Two_Menu_F1_E2[1] == 9)
 538   7                                                                                                {
 539   8                                                                                                        Two_Menu_F1_E2[0]++;
 540   8                                                                                                        Two_Menu_F1_E2[1] = 0;
 541   8                                                                                                        Two_Menu_F1_E2[2] = 0;
 542   8                                                                                                        if (Two_Menu_F1_E2[0] == 21)
 543   8                                                                                                        {
 544   9                                                                                                                Two_Menu_F1_E2[0] = 0;
 545   9                                                                                                                Two_Menu_F1_E2[3] = 1;
 546   9                                                                                                        }
 547   8                                                                                                        else
 548   8                                                                                                        {
 549   9                                                                                                                Two_Menu_F1_E2[3] = 1;
 550   9                                                                                                        }
 551   8      
 552   8      
 553   8                                                                                                }
 554   7                                                                                                else
 555   7                                                                                                {
 556   8                                                                                                        Two_Menu_F1_E2[1]++;
 557   8                                                                                                        Two_Menu_F1_E2[2] = 0;
 558   8                                                                                                        Two_Menu_F1_E2[3] = 0;
 559   8                                                                                                }
 560   7                                                                                        }
 561   6                                                                                        else
 562   6                                                                                        {
 563   7                                                                                                Two_Menu_F1_E2[2]++;
 564   7                                                                                                Two_Menu_F1_E2[3] = 0;
 565   7                                                                                        }
 566   6                                                                                }
 567   5                                                                                else
 568   5                                                                                        Two_Menu_F1_E2[3]++;
 569   5                                                                        }
 570   4                                                                        break;
 571   4                      }
 572   3      
 573   3                      case TWO_MENU_F1_E3_D1:
 574   3                      case TWO_MENU_F1_E3_D2:
 575   3                      case TWO_MENU_F1_E3_D3:
 576   3                      case TWO_MENU_F1_E3_D4:
 577   3                      {
 578   4                              set_func_index(TWO_MENU_F1_E3_D4);
 579   4      
 580   4                              memcpy(tmp.region, Two_Menu_F1_E3, 4);
 581   4                              tmp.rf = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32_t)old2
             -_RF_RECE_REG[2]);
 582   4      
 583   4                              if (!register_alarm_function(&tmp))// ˝÷µ◊‘∂Øº”1
 584   4                              {
 585   5      #ifdef DEBUG
                                              uart_printf("alarm is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6],
             - (unsigned int)buf_eeprom[7]); //≤‚ ‘∞¥º¸º¸÷µ
                                              uart_printf("alarm is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E3[0], (unsigned int)Two_Me
             -nu_F1_E3[1], (unsigned int)Two_Menu_F1_E3[2], (unsigned int)Two_Menu_F1_E3[3]);
                                              uart_printf("alarm is rigister success \r\n");
              #endif                                  
 590   5                                      delay10ms();
 591   5                                      if (Two_Menu_F1_E3[3] == 9)
 592   5                                      {
 593   6                                              if (Two_Menu_F1_E3[2] == 9)
 594   6                                              {
 595   7                                                      if (Two_Menu_F1_E3[1] == 9)
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 11  

 596   7                                                      {
 597   8                                                              Two_Menu_F1_E3[0]++;
 598   8                                                              Two_Menu_F1_E3[1] = 0;
 599   8                                                              Two_Menu_F1_E3[2] = 0;
 600   8                                                              if (Two_Menu_F1_E3[0] == 21)
 601   8                                                              {
 602   9                                                                      Two_Menu_F1_E3[0] = 0;
 603   9                                                                      Two_Menu_F1_E3[3] = 1;
 604   9                                                              }
 605   8                                                              else
 606   8                                                              {
 607   9                                                                      Two_Menu_F1_E3[3] = 1;
 608   9                                                              }
 609   8                                                      }
 610   7                                                      else
 611   7                                                      {
 612   8                                                              Two_Menu_F1_E3[1]++;
 613   8                                                              Two_Menu_F1_E3[2] = 0;
 614   8                                                              Two_Menu_F1_E3[3] = 0;
 615   8                                                      }
 616   7                                              }
 617   6                                              else
 618   6                                              {
 619   7                                                      Two_Menu_F1_E3[2]++;
 620   7                                                      Two_Menu_F1_E3[3] = 0;
 621   7                                              }
 622   6                                      }
 623   5                                      else
 624   5                                              Two_Menu_F1_E3[3]++;
 625   5                              }
 626   4                              break;
 627   4                      }
 628   3                      case TWO_MENU_F1_E4_D1:
 629   3                      case TWO_MENU_F1_E4_D2:
 630   3                      case TWO_MENU_F1_E4_D3:
 631   3                      case TWO_MENU_F1_E4_D4:
 632   3                      {
 633   4                              set_func_index(TWO_MENU_F1_E4_D4);
 634   4      
 635   4                              memcpy(tmp.region, Two_Menu_F1_E4, 4);
 636   4                              tmp.rf = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32_t)old2
             -_RF_RECE_REG[2]);
 637   4      
 638   4      
 639   4                              if (!register_cancel_function(&tmp))// ˝÷µ◊‘∂Øº”1
 640   4                              {
 641   5      #ifdef DEBUG
                                              uart_printf("cancel is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6]
             -, (unsigned int)buf_eeprom[7]); //≤‚ ‘∞¥º¸º¸÷µ
                                              uart_printf("cancel is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E4[0], (unsigned int)Two_M
             -enu_F1_E4[1], (unsigned int)Two_Menu_F1_E4[2], (unsigned int)Two_Menu_F1_E4[3]);
                                              uart_printf("cancel is rigister success \r\n");
              #endif                                  
 646   5                                      delay10ms();
 647   5                                      if (Two_Menu_F1_E4[3] == 9)
 648   5                                      {
 649   6                                              if (Two_Menu_F1_E4[2] == 9)
 650   6                                              {
 651   7                                                      if (Two_Menu_F1_E4[1] == 9)
 652   7                                                      {
 653   8                                                              Two_Menu_F1_E4[0]++;
 654   8                                                              Two_Menu_F1_E4[1] = 0;
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 12  

 655   8                                                              Two_Menu_F1_E4[2] = 0;
 656   8                                                              if (Two_Menu_F1_E4[0] == 21)
 657   8                                                              {
 658   9                                                                      Two_Menu_F1_E4[0] = 0;
 659   9                                                                      Two_Menu_F1_E4[3] = 1;
 660   9                                                              }
 661   8                                                              else
 662   8                                                              {
 663   9                                                                      Two_Menu_F1_E4[3] = 1;
 664   9                                                              }
 665   8                                                      }
 666   7                                                      else
 667   7                                                      {
 668   8                                                              Two_Menu_F1_E4[1]++;
 669   8                                                              Two_Menu_F1_E4[2] = 0;
 670   8                                                              Two_Menu_F1_E4[3] = 0;
 671   8                                                      }
 672   7                                              }
 673   6                                              else
 674   6                                              {
 675   7                                                      Two_Menu_F1_E4[2]++;
 676   7                                                      Two_Menu_F1_E4[3] = 0;
 677   7                                              }
 678   6                                      }
 679   5                                      else
 680   5                                              Two_Menu_F1_E4[3]++;
 681   5                              }
 682   4                              break;
 683   4                      }
 684   3                      case TWO_MENU_F8_E2_SET :
 685   3                              set_sound_table(0);
 686   3                              Two_menu_set_success = 1;
 687   3                              if (Two_Menu_F8_E1_temp == 1)
 688   3                              {
 689   4                                      single_key[old2_RF_RECE_REG[2] & 0x0f] = Two_Menu_F8_E2_temp;
 690   4                                      ISendStr(I2C_ADDRESS, SIN_KEY, single_key, 16);
 691   4                              }
 692   3                              else
 693   3                              {
 694   4                                      multiple_key[old2_RF_RECE_REG[2] & 0x0f] = Two_Menu_F8_E2_temp;
 695   4                                      ISendStr(I2C_ADDRESS, MUL_KEY, multiple_key, 16);
 696   4                              }
 697   3      #ifdef DEBUG
                                      uart_printf("single_key£∫  ");
                                      for (i = 0; i < 16; i++)
                                      {
                                              
                                              uart_printf("%02d ", (unsigned int)single_key[i]);
                                      }
                                      uart_printf(" \r\n");
              
                                      uart_printf("multiple_key£∫");
                                      for (i = 0; i < 16; i++)
                                      {
              
                                              uart_printf("%2d ", (unsigned int)multiple_key[i]);
                                      }
                                      uart_printf(" \r\n");
              #endif  
 714   3      
 715   3                              break;
 716   3      
C51 COMPILER V9.00   DECODER                                                               11/07/2015 16:25:06 PAGE 13  

 717   3      
 718   3                      default:break;//ƒ¨»œµƒbreak
 719   3                      }
 720   2                      clear_again_receive_rf_decoder_finished();//«Â≥˝±Í÷æŒª
 721   2              }
 722   1              
 723   1              LogoutProcess();
 724   1              CycleProcess();
 725   1      }
*** WARNING C280 IN LINE 23 OF RECEIVER\DECODER.C: 'i': unreferenced local variable
*** WARNING C280 IN LINE 23 OF RECEIVER\DECODER.C: 'j': unreferenced local variable
 726          
 727          unsigned char return_Two_menu_set_success(void)
 728          {
 729   1              unsigned char temp = 0;
 730   1              temp = Two_menu_set_success;
 731   1              return temp;
 732   1      }
 733          
 734          void set_Two_menu_set_success(unsigned char temp)
 735          {
 736   1              Two_menu_set_success = temp;
 737   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3692    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     14      43
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
