C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE DECODER
OBJECT MODULE PLACED IN decoder.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Receiver\decoder.c LARGE BROWSE INCDIR(.\Receiver) DEBUG OBJECTEXTEND PRINT
                    -(.\decoder.lst) OBJECT(decoder.obj)

line level    source

   1          #include "decoder.h"
   2          #include "ev1527.h"
   3          #include "usart.h"
   4          #include "at24c256.h"
   5          #include "key.h"
   6          #include "menu.h"
   7          #include "tm1629.h"
   8          #include "timer.h"
   9          #include "gd5800.h"
  10          #include "com.h"
  11          
  12          unsigned char buf_eeprom[8] = { 0 };//–¥»ÎEEPROM_buf
  13          unsigned char Two_menu_set_success = 0;
  14          uint32_t last_dat = 0;
  15          
  16          void DecoderProcess(void)
  17          {       
  18   1              RF_def tmp;
  19   1              RF_def RFtmp;
  20   1              uint32_t dat;
  21   1              int state = 0;
  22   1              unsigned char i, j ,l ,k ,index=0;
  23   1              unsigned char temp_buff[8];//Ω‚¬Î”√¡Ÿ ± ˝◊È
  24   1      
  25   1              unsigned char func_index_temp = 0;              //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  26   1              unsigned char Two_Menu_F8_E1_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  27   1              unsigned char Two_Menu_F8_E2_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  28   1              unsigned char Two_Menu_F3_E1_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø    
  29   1              unsigned char Two_Menu_F3_E2_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  30   1              unsigned char Two_Menu_F7_E1_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  31   1              unsigned char Two_Menu_F6_E1_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  32   1              unsigned char Two_Menu_F6_E2_temp = 0;  //¥¥Ω®¡Ÿ ±±‰¡ø£¨”√”⁄∑≈ªÿ∆‰À˚Õ‚≤ø±‰¡ø
  33   1      
  34   1              func_index_temp = return_func_index();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  35   1              Two_Menu_F8_E1_temp = return_Two_Menu_F8_E1();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  36   1              Two_Menu_F8_E2_temp = return_Two_Menu_F8_E2();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  37   1              Two_Menu_F3_E1_temp = return_Two_Menu_F3_E1();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  38   1              Two_Menu_F3_E2_temp = return_Two_Menu_F3_E2();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  39   1              index                       = return_Two_Menu_F3_E2();
  40   1              Two_Menu_F7_E1_temp = return_Two_Menu_F7_E1();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  41   1              Two_Menu_F6_E1_temp = return_Two_Menu_F6_E1();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  42   1              Two_Menu_F6_E2_temp = return_Two_Menu_F6_E2();  //∑µªÿÀ˘–Ë“™µƒÕ‚≤ø±‰¡ø
  43   1      
  44   1              receive_rf_decoder();   //Ω‚¬Î∫Ø ˝
  45   1      
  46   1              if (return_again_receive_rf_decoder_finished() == 1) //±Í÷æŒªµ»”⁄1 Àµ√˜‘⁄2¥ŒºÏ—Èœ¬Õ®π˝,Ω” ’µΩ”––ß¬Î
  47   1              {
  48   2      #ifdef DEBUG1
                              uart_printf("decoder_val is %02x %02x %02x .\r\n", (unsigned int)old2_RF_RECE_REG[0], (unsigned int)old2
             -_RF_RECE_REG[1], (unsigned int)old2_RF_RECE_REG[2]); //≤‚ ‘∞¥º¸º¸÷µ
              #endif
  51   2                      dat = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32_t)old2_RF_
             -RECE_REG[2]);
  52   2                      switch (func_index_temp)
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 2   

  53   2                      {
  54   3                      case MENU_STANDBY://¥˝ª˙◊¥Ã¨œ¬
  55   3                      {
  56   4                              set_logout_cycle_table(0);//—≠ª∑∏˙œ˙∫≈÷ÿ–¬º∆ ˝
  57   4                              //º¸≈ÃπÊ‘Ú
  58   4                              if ((old2_RF_RECE_REG[2] & 0xf0) == 0x00 && ((old2_RF_RECE_REG[0] >> 4) == Two_Menu_F7_E1_temp) && (old
             -2_RF_RECE_REG[0] >> 4) < 10)//º¸≈ÃπÊ‘Ú£¨≥Ã–Ú∞¥ƒ¨»œµƒ¿¥±‡
  59   4                              {
  60   5                                      if (Two_Menu_F8_E1_temp == 1)  //Œ™∞¥º¸÷µ
  61   5                                      {
  62   6                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f] ;
  63   6                                      }
  64   5                                      else
  65   5                                      {
  66   6                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
  67   6                                      }   
  68   5                                      temp_buff[1] = old2_RF_RECE_REG[0] >> 4;        //Œ™∑¿«¯∫≈
  69   5                                      temp_buff[2] = old2_RF_RECE_REG[0] & 0x0f;      //Œ™3Œª◊È¬Îµ⁄“ªŒª
  70   5                                      temp_buff[3] = old2_RF_RECE_REG[1] >> 4;        //Œ™3Œª◊È¬Îµ⁄∂˛Œª
  71   5                                      temp_buff[4] = old2_RF_RECE_REG[1] & 0x0f;      //Œ™3Œª◊È¬Îµ⁄»˝Œª
  72   5                                      temp_buff[5] = old2_RF_RECE_REG[0];                     //±∏”√œÓ,‘›«“¥Êµ⁄1ŒªID¬Î
  73   5                                      temp_buff[6] = old2_RF_RECE_REG[1];                     //±∏”√œÓ,‘›«“¥Êµ⁄2ŒªID¬Î
  74   5                                      temp_buff[7] = old2_RF_RECE_REG[2];                     //±∏”√œÓ,‘›«“¥Êµ⁄3ŒªID¬Î
  75   5      
  76   5                                      if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
  77   5                                      {
  78   6                                              for (l = 0; l < Two_Menu_F6_E2_temp; l++)
  79   6                                              {
  80   7                                                      submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
  81   7                                              }
  82   6                                      }
  83   5                                      else
  84   5                                      {
  85   6                                              Cancel_funtion(temp_buff,display_ram);//»°œ˚∫Ø ˝
  86   6                                              mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
  87   6                                              tm1629_load();
  88   6                                              display();
  89   6                                              break;
  90   6                                      }               
  91   5      
  92   5                                      tm1629_clear();//«Â∆¡
  93   5                                      mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
  94   5                                      decoder_temp_to_mcuram(display_ram, temp_buff);//Ω´¡Ÿ ± ˝◊Èµƒ ˝æ›“∆»Îµ•∆¨ª˙‘›¥Ê ˝◊È 8◊÷Ω⁄◊™6◊÷Ω⁄
  95   5                                      tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
  96   5                                      display();//œ‘ æ ˝¬Îπ‹
  97   5                                      set_func_index(DECODER_MENU);//¥À ±Ã¯»ÎΩ‚¬Î≤Àµ•£¨Œ™œ¬“ª¥ŒΩ‚¬Î◊ˆ◊º±∏
  98   5                                      //clear_again_receive_rf_decoder_finished();//«Â≥˝Ω‚¬ÎÕÍ≥…±Í÷æŒª
  99   5      
 100   5                                      break;
 101   5                              }
 102   4                              //∫ÙΩ–∆˜◊¢≤·,À—À˜À˘–Ë“™µƒ∫ÙΩ–∆˜
 103   4      #ifdef DEBUG
                                      uart_printf("dat is : %x %x \r\n", (unsigned int)(dat >> 16), (unsigned int)dat);
              #endif
 106   4                              if (state = Find_RF_EEPROM(&RFtmp, dat))
 107   4                              {
 108   5                                      if (last_dat == dat)
 109   5                                      {
 110   6                                              if (return_second_filter_table() != 0)
 111   6                                              {
 112   7                                                      goto standby;
 113   7                                              }
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 3   

 114   6                                      
 115   6                                      }
 116   5                                      else
 117   5                                      {
 118   6                                              last_dat = dat;
 119   6                                              clear_second_filter_time();
 120   6                                              set_second_filter_table(1);
 121   6                                      }
 122   5      
 123   5      #ifdef DEBUG
                                              uart_printf("Find_RF_EEPROM \r\n");
                                              uart_printf("state is : %x \r\n", (unsigned int)state);
              #endif
 127   5                                      if (state == 1)
 128   5                                      {
 129   6                                              temp_buff[0] = QUXIAO_1;
 130   6                                      }
 131   5                                      else if (state == 2)
 132   5                                      {
 133   6                                              temp_buff[0] = BAOJING_1;
 134   6                                      }
 135   5                                      else
 136   5                                      {
 137   6                                              temp_buff[0] = old2_RF_RECE_REG[2] & 0x0f;
 138   6                                      }
 139   5      
 140   5      #ifdef DEBUG
                                              uart_printf("temp[0] is : %x \r\n", (unsigned int)temp_buff[0]);
              #endif
 143   5                                      memcpy(temp_buff+1, RFtmp.region, 4);
 144   5                                      temp_buff[7] = old2_RF_RECE_REG[2];
 145   5      
 146   5                                      if (temp_buff[0] < 50)
 147   5                                      {
 148   6      #ifdef DEBUG
                                                      uart_printf("temp_buff[0] < 50 \r\n");
              #endif
 151   6                                              if (Two_Menu_F8_E1_temp == 1)  //Œ™∞¥º¸÷µ
 152   6                                              {
 153   7      
 154   7                                                      temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 155   7                                              }
 156   6                                              else
 157   6                                              {
 158   7      
 159   7                                                      temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 160   7                                              }
 161   6                                      }
 162   5      
 163   5      #ifdef DEBUG
                                              uart_printf("temp[0] is : %x \r\n", (unsigned int)temp_buff[0]);
              #endif
 166   5      
 167   5      
 168   5      #ifdef DEBUG
                                              uart_printf("cancen funtion \r\n");
              #endif
 171   5                                      //”Ô“Ù∫Ø ˝
 172   5                                      if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 173   5                                      {
 174   6      #ifdef DEBUG
                                                      uart_printf("cancen funtion fault \r\n");
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 4   

              #endif
 177   6                                              for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 178   6                                              {
 179   7                                                      submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 180   7                                              }
 181   6                                      }
 182   5                                      else
 183   5                                      {
 184   6      #ifdef DEBUG
                                                      uart_printf("cancen funtion success \r\n");
              #endif
 187   6                                              mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 188   6                                              Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 189   6                                              tm1629_load();
 190   6                                              display();
 191   6                                              goto standby;
 192   6                                      }
 193   5      
 194   5                                      tm1629_clear();//«Â∆¡
 195   5                                      mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 196   5                                      decoder_temp_to_mcuram(display_ram, temp_buff);//»Áπ˚∑˚∫œµƒª∞  Ω´¡Ÿ ± ˝◊Èµƒ ˝æ›“∆»Îµ•∆¨ª˙‘›¥Ê ˝◊È 8◊÷Ω
             -⁄◊™6◊÷Ω⁄
 197   5                                      tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 198   5                                      display();//œ‘ æ ˝¬Îπ‹
 199   5      #ifdef DEBUG
                                              uart_printf("decoder success!");
              #endif
 202   5      
 203   5                                      set_func_index(DECODER_MENU);;//¥À ±Ã¯»ÎΩ‚¬Î≤Àµ•£¨Œ™œ¬“ª¥ŒΩ‚¬Î◊ˆ◊º±∏
 204   5                                      clear_again_receive_rf_decoder_finished();//«Â≥˝Ω‚¬ÎÕÍ≥…±Í÷æŒª
 205   5                                      goto standby;
 206   5      
 207   5                              }
 208   4      standby:
 209   4                               break;
 210   4                      }
 211   3      
 212   3                      case DECODER_MENU: //Ω‚¬Î≤Àµ•œ¬
 213   3                      {
 214   4                              set_logout_cycle_table(0);//—≠ª∑∏˙œ˙∫≈÷ÿ–¬º∆ ˝
 215   4                               //º¸≈ÃπÊ‘Ú
 216   4                              if ((old2_RF_RECE_REG[2] & 0xf0) == 0x00 && ((old2_RF_RECE_REG[0] >> 4) == Two_Menu_F7_E1_temp) && (old
             -2_RF_RECE_REG[0] >> 4) < 10)//º¸≈ÃπÊ‘Ú£¨≥Ã–Ú∞¥ƒ¨»œµƒ¿¥±‡
 217   4                              {
 218   5                                      if (Two_Menu_F8_E1_temp == 1)  //Œ™∞¥º¸÷µ
 219   5                                      {
 220   6                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 221   6                                      }
 222   5                                      else
 223   5                                      {
 224   6                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 225   6                                      }
 226   5                                      temp_buff[1] = old2_RF_RECE_REG[0] >> 4;        //Œ™∑¿«¯∫≈
 227   5                                      temp_buff[2] = old2_RF_RECE_REG[0] & 0x0f;      //Œ™3Œª◊È¬Îµ⁄“ªŒª
 228   5                                      temp_buff[3] = old2_RF_RECE_REG[1] >> 4;        //Œ™3Œª◊È¬Îµ⁄∂˛Œª
 229   5                                      temp_buff[4] = old2_RF_RECE_REG[1] & 0x0f;      //Œ™3Œª◊È¬Îµ⁄»˝Œª
 230   5                                      temp_buff[5] = old2_RF_RECE_REG[0];                     //±∏”√œÓ,‘›«“¥Êµ⁄“ªŒªID¬Î
 231   5                                      temp_buff[6] = old2_RF_RECE_REG[1];                     //±∏”√œÓ,‘›«“¥Êµ⁄∂˛ŒªID¬Î
 232   5                                      temp_buff[7] = old2_RF_RECE_REG[2];                     //±∏”√œÓ,‘›«“¥Êµ⁄»˝ŒªID¬Î
 233   5                                      if (Two_Menu_F3_E1_temp == 1)                           //Œ™º¥ ±ƒ£ Ω
 234   5                                      {       
 235   6                                              if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 5   

 236   6                                              {
 237   7                                                      for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 238   7                                                      {
 239   8                                                              submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 240   8                                                      }
 241   7                                              }
 242   6                                              else
 243   6                                              {
 244   7                                                      mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 245   7                                                      Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 246   7                                                      tm1629_load();
 247   7                                                      display();
 248   7                                                      break;
 249   7                                              }
 250   6                                              mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 251   6                                              Search_funtion(temp_buff, display_ram);
 252   6      
 253   6                                              for (l = Two_Menu_F3_E2_temp; l>1; l--) //’˚ÃÂÕ˘œ¬“∆“ª◊È ˝æ›
 254   6                                              {
 255   7                                                      mcuram_to_mcuram_down(display_ram + ((l - 2)<<3));
 256   7                                              }
 257   6                                              for (l = 0; l<6; l++) //Ω≤µ⁄“ª◊È ˝æ›«Â0
 258   6                                              {
 259   7                                                      display_ram[l] = 0;
 260   7                                              }
 261   6                                                      
 262   6                                              decoder_temp_to_mcuram(display_ram, temp_buff); //»Áπ˚∑˚∫œµƒª∞  Ω´¡Ÿ ± ˝◊Èµƒ ˝æ›“∆»Îµ•∆¨ª˙‘›¥Ê ˝◊È 8◊
             -÷Ω⁄◊™6◊÷Ω⁄                        
 263   6                                              tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 264   6                                              display();//œ‘ æ ˝¬Îπ‹
 265   6                                      }
 266   5                                      else if (Two_Menu_F3_E1_temp == 2)//Œ™—≠ª∑ƒ£ Ω
 267   5                                      {
 268   6                                              if (temp_buff[0] == QUXIAO_1 || temp_buff[0] == 0)
 269   6                                              {
 270   7                                                      mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 271   7                                                      Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 272   7                                                      tm1629_load();
 273   7                                                      display();
 274   7                                                      break;
 275   7                                              }
 276   6                                              for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 277   6                                              {
 278   7                                                      if (display_ram[(k << 3) + 1] == temp_buff[1] && display_ram[(k << 3) + 2] == temp_buff[2] && displa
             -y_ram[(k << 3) + 3] == temp_buff[3] && display_ram[(k << 3) + 4] == temp_buff[4])
 279   7                                                      {
 280   8                                                              index = k;
 281   8                                                              decoder_temp_to_mcuram(display_ram + (k << 3), temp_buff);
 282   8                                                              tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 283   8                                                              display();//œ‘ æ ˝¬Îπ‹
 284   8                                                              break;
 285   8                                                      }
 286   7                                              }
 287   6      
 288   6                                              if (index == Two_Menu_F3_E2_temp)
 289   6                                              {
 290   7                                                      for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 291   7                                                      {
 292   8                                                              if (display_ram[(k << 3)] == 0)//’“≥ˆŒª”⁄∂”¡–◊Ó∫Ûµƒƒ«∏ˆµ„
 293   8                                                              {
 294   9                                                                      mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 295   9                                                                      decoder_temp_to_mcuram(display_ram + (k << 3), temp_buff);
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 6   

 296   9                                                                      tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 297   9                                                                      display();//œ‘ æ ˝¬Îπ‹
 298   9                                                                      break;
 299   9      
 300   9                                                              }
 301   8                                                      }
 302   7                                              }
 303   6                                      }
 304   5                                      //clear_again_receive_rf_decoder_finished();//«Â≥˝Ω‚¬ÎÕÍ≥…±Í÷æŒª
 305   5                                      break;
 306   5                              }
 307   4                              //∫ÙΩ–∆˜◊¢≤·,À—À˜À˘–Ë“™µƒ∫ÙΩ–∆˜
 308   4                              if (state = Find_RF_EEPROM(&RFtmp, dat))
 309   4                              {
 310   5                                      if (last_dat == dat)
 311   5                                      {
 312   6                                              if (return_second_filter_table() != 0)
 313   6                                              {
 314   7                                                      goto decoder;
 315   7                                              }
 316   6      
 317   6                                      }
 318   5                                      else
 319   5                                      {
 320   6                                              last_dat = dat;
 321   6                                              clear_second_filter_time();
 322   6                                              set_second_filter_table(1);
 323   6                                      }
 324   5      #ifdef DEBUG
                                              uart_printf("Find_RF_EEPROM \r\n");
              #endif
 327   5                                      if (state == 1)
 328   5                                      {
 329   6                                              temp_buff[0] = QUXIAO_1;
 330   6                                      }
 331   5                                      else if (state == 2)
 332   5                                      {
 333   6                                              temp_buff[0] = BAOJING_1;
 334   6                                      }
 335   5                                      else
 336   5                                      {
 337   6                                              temp_buff[0] = old2_RF_RECE_REG[2] & 0x0f;
 338   6                                      }
 339   5      
 340   5                                      memcpy(temp_buff + 1, RFtmp.region, 4);
 341   5                                      temp_buff[7] = old2_RF_RECE_REG[2];
 342   5      
 343   5                                      if (temp_buff[0] < 50)
 344   5                                      {
 345   6                                              if (Two_Menu_F8_E1_temp == 1)  //Œ™∞¥º¸÷µ
 346   6                                              {
 347   7      
 348   7                                                      temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 349   7                                              }
 350   6                                              else
 351   6                                              {
 352   7      
 353   7                                                      temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 354   7                                              }
 355   6                                      }
 356   5      
 357   5                                      if (Two_Menu_F3_E1_temp == 1)//Œ™º¥ ±ƒ£ Ω
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 7   

 358   5                                      {
 359   6      
 360   6                                              if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 361   6                                              {
 362   7      #ifdef DEBUG
                                                              uart_printf("cancen funtion fault \r\n");
              #endif
 365   7                                                      for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 366   7                                                      {
 367   8                                                              submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 368   8                                                      }
 369   7                                              }
 370   6                                              else
 371   6                                              {
 372   7      #ifdef DEBUG
                                                              uart_printf("cancen funtion success \r\n");
              #endif
 375   7                                                      mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 376   7                                                      Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 377   7                                                      tm1629_load();
 378   7                                                      display();
 379   7                                                      goto decoder;
 380   7                                              }
 381   6      
 382   6                                              mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 383   6                                              Search_funtion(temp_buff, display_ram);
 384   6      
 385   6                                              for (l = Two_Menu_F3_E2_temp; l > 1; l--) //’˚ÃÂÕ˘œ¬“∆“ª◊È ˝æ›
 386   6                                              {
 387   7                                                      mcuram_to_mcuram_down(display_ram + ((l - 2) << 3));
 388   7                                              }
 389   6                                              for (l = 0; l < 6; l++) //Ω≤µ⁄“ª◊È ˝æ›«Â0
 390   6                                              {
 391   7                                                      display_ram[l] = 0;
 392   7                                              }
 393   6      
 394   6                                              decoder_temp_to_mcuram(display_ram, temp_buff); //»Áπ˚∑˚∫œµƒª∞  Ω´¡Ÿ ± ˝◊Èµƒ ˝æ›“∆»Îµ•∆¨ª˙‘›¥Ê ˝◊È 8◊
             -÷Ω⁄◊™6◊÷Ω⁄
 395   6                                              tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 396   6                                              display();//œ‘ æ ˝¬Îπ‹
 397   6                                      }
 398   5                                      else if (Two_Menu_F3_E1_temp == 2)//Œ™—≠ª∑ƒ£ Ω
 399   5                                      {
 400   6                                              if (temp_buff[0] == QUXIAO_1 || temp_buff[0] == 0)
 401   6                                              {
 402   7                                                      mcu_to_computer(0x92, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 403   7                                                      Cancel_funtion(temp_buff, display_ram);//»°œ˚∫Ø ˝
 404   7                                                      tm1629_load();
 405   7                                                      display();
 406   7                                                      break;
 407   7                                              }
 408   6      
 409   6                                              for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 410   6                                              {
 411   7                                                      if (display_ram[(k << 3) + 1] == temp_buff[1] && display_ram[(k << 3) + 2] == temp_buff[2] && displa
             -y_ram[(k << 3) + 3] == temp_buff[3] && display_ram[(k << 3) + 4] == temp_buff[4])
 412   7                                                      {
 413   8                                                              index = k;
 414   8                                                              decoder_temp_to_mcuram(display_ram + (k << 3), temp_buff);
 415   8                                                              tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 416   8                                                              display();//œ‘ æ ˝¬Îπ‹
 417   8                                                              break;
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 8   

 418   8                                                      }
 419   7                                              }
 420   6      
 421   6                                              if (index == Two_Menu_F3_E2_temp)
 422   6                                              {
 423   7                                                      for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 424   7                                                      {
 425   8                                                              if (display_ram[(k << 3)] == 0)//’“≥ˆŒª”⁄∂”¡–◊Ó∫Ûµƒƒ«∏ˆµ„
 426   8                                                              {
 427   9                                                                      mcu_to_computer(0x91, temp_buff, old2_RF_RECE_REG[2] & 0x0f);//…œŒªª˙
 428   9                                                                      decoder_temp_to_mcuram(display_ram + (k << 3), temp_buff);
 429   9                                                                      tm1629_load();//µ•∆¨ª˙∞— ˝◊Èƒ⁄»›‘ÿ»Î ˝¬Îπ‹œ‘¥Ê ˝◊È÷–
 430   9                                                                      display();//œ‘ æ ˝¬Îπ‹
 431   9                                                                      break;
 432   9      
 433   9                                                              }
 434   8                                                      }
 435   7                                              }
 436   6                                      }
 437   5      #ifdef DEBUG
                                              uart_printf("decoder success!");
              #endif
 440   5                                      clear_again_receive_rf_decoder_finished();
 441   5                                      goto decoder;
 442   5      
 443   5                              }
 444   4                                      
 445   4                              
 446   4      decoder:
 447   4                              break;
 448   4                      }
 449   3      
 450   3                      case TWO_MENU_F1_E1_D1:
 451   3                      case TWO_MENU_F1_E1_D2:
 452   3                      case TWO_MENU_F1_E1_D3:
 453   3                      case TWO_MENU_F1_E1_D4:
 454   3                      {
 455   4                              set_func_index(TWO_MENU_F1_E1_D4);
 456   4      
 457   4                              memcpy(tmp.region, Two_Menu_F1_E1, 4);
 458   4                              tmp.rf = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32_t)old2
             -_RF_RECE_REG[2]);
 459   4                              if (!(register_call_function(&tmp)))// ˝÷µ◊‘∂Øº”1
 460   4                              {
 461   5      #ifdef DEBUG
                                              uart_printf("dat is : %x %x \r\n", (unsigned int)(tmp.rf >> 16), (unsigned int)tmp.rf);
                                              uart_printf("call is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E1[0], (unsigned int)Two_Men
             -u_F1_E1[1], (unsigned int)Two_Menu_F1_E1[2], (unsigned int)Two_Menu_F1_E1[3]);
                                              uart_printf("caller is rigister success \r\n");
              #endif                                  
 466   5                                      delay10ms();
 467   5                                      if (Two_Menu_F1_E1[3] == 9)
 468   5                                      {
 469   6                                              if (Two_Menu_F1_E1[2] == 9)
 470   6                                              {
 471   7                                                      if (Two_Menu_F1_E1[1] == 9)
 472   7                                                      {
 473   8                                                              Two_Menu_F1_E1[0]++;
 474   8                                                              Two_Menu_F1_E1[1] = 0;
 475   8                                                              Two_Menu_F1_E1[2] = 0;
 476   8                                                              if (Two_Menu_F1_E1[0] == 21)
 477   8                                                              {
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 9   

 478   9                                                                      Two_Menu_F1_E1[0] = 0;
 479   9                                                                      Two_Menu_F1_E1[3] = 1;
 480   9                                                              }
 481   8                                                              else
 482   8                                                              {
 483   9                                                                      Two_Menu_F1_E1[3] = 1;
 484   9                                                              }
 485   8                                                      }
 486   7                                                      else
 487   7                                                      {
 488   8                                                              Two_Menu_F1_E1[1]++;
 489   8                                                              Two_Menu_F1_E1[2] = 0;
 490   8                                                              Two_Menu_F1_E1[3] = 0;
 491   8                                                      }
 492   7                                              }
 493   6                                              else
 494   6                                              {
 495   7                                                      Two_Menu_F1_E1[2]++;
 496   7                                                      Two_Menu_F1_E1[3] = 0;
 497   7                                              }
 498   6                                      }
 499   5                                      else
 500   5                                              Two_Menu_F1_E1[3]++;
 501   5                              }
 502   4                              break;
 503   4                      }
 504   3      
 505   3                      case TWO_MENU_F1_E2_D1:
 506   3                      case TWO_MENU_F1_E2_D2:
 507   3                      case TWO_MENU_F1_E2_D3:
 508   3                      case TWO_MENU_F1_E2_D4:
 509   3                      {
 510   4                                                                        set_func_index(TWO_MENU_F1_E2_D4);
 511   4                                                                        memcpy(tmp.region, Two_Menu_F1_E2, 4);
 512   4                                                                        tmp.rf = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32
             -_t)old2_RF_RECE_REG[2]);
 513   4      
 514   4                                                                        if (!register_host_function(&tmp))// ˝÷µ◊‘∂Øº”1
 515   4                                                                        {
 516   5      #ifdef DEBUG
                                                                                        uart_printf("host is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eepr
             -om[6], (unsigned int)buf_eeprom[7]); //≤‚ ‘∞¥º¸º¸÷µ
                                                                                        uart_printf("host is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E2[0], (unsigned int)
             -Two_Menu_F1_E2[1], (unsigned int)Two_Menu_F1_E2[2], (unsigned int)Two_Menu_F1_E2[3]);
                                                                                        uart_printf("host is rigister success \r\n");
              #endif                                  
 521   5                                                                                delay10ms();
 522   5                                                                                if (Two_Menu_F1_E2[3] == 9)
 523   5                                                                                {
 524   6                                                                                        if (Two_Menu_F1_E2[2] == 9)
 525   6                                                                                        {
 526   7                                                                                                if (Two_Menu_F1_E2[1] == 9)
 527   7                                                                                                {
 528   8                                                                                                        Two_Menu_F1_E2[0]++;
 529   8                                                                                                        Two_Menu_F1_E2[1] = 0;
 530   8                                                                                                        Two_Menu_F1_E2[2] = 0;
 531   8                                                                                                        if (Two_Menu_F1_E2[0] == 21)
 532   8                                                                                                        {
 533   9                                                                                                                Two_Menu_F1_E2[0] = 0;
 534   9                                                                                                                Two_Menu_F1_E2[3] = 1;
 535   9                                                                                                        }
 536   8                                                                                                        else
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 10  

 537   8                                                                                                        {
 538   9                                                                                                                Two_Menu_F1_E2[3] = 1;
 539   9                                                                                                        }
 540   8      
 541   8      
 542   8                                                                                                }
 543   7                                                                                                else
 544   7                                                                                                {
 545   8                                                                                                        Two_Menu_F1_E2[1]++;
 546   8                                                                                                        Two_Menu_F1_E2[2] = 0;
 547   8                                                                                                        Two_Menu_F1_E2[3] = 0;
 548   8                                                                                                }
 549   7                                                                                        }
 550   6                                                                                        else
 551   6                                                                                        {
 552   7                                                                                                Two_Menu_F1_E2[2]++;
 553   7                                                                                                Two_Menu_F1_E2[3] = 0;
 554   7                                                                                        }
 555   6                                                                                }
 556   5                                                                                else
 557   5                                                                                        Two_Menu_F1_E2[3]++;
 558   5                                                                        }
 559   4                                                                        break;
 560   4                      }
 561   3      
 562   3                      case TWO_MENU_F1_E3_D1:
 563   3                      case TWO_MENU_F1_E3_D2:
 564   3                      case TWO_MENU_F1_E3_D3:
 565   3                      case TWO_MENU_F1_E3_D4:
 566   3                      {
 567   4                              set_func_index(TWO_MENU_F1_E3_D4);
 568   4      
 569   4                              memcpy(tmp.region, Two_Menu_F1_E3, 4);
 570   4                              tmp.rf = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32_t)old2
             -_RF_RECE_REG[2]);
 571   4      
 572   4                              if (!register_alarm_function(&tmp))// ˝÷µ◊‘∂Øº”1
 573   4                              {
 574   5      #ifdef DEBUG
                                              uart_printf("alarm is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6],
             - (unsigned int)buf_eeprom[7]); //≤‚ ‘∞¥º¸º¸÷µ
                                              uart_printf("alarm is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E3[0], (unsigned int)Two_Me
             -nu_F1_E3[1], (unsigned int)Two_Menu_F1_E3[2], (unsigned int)Two_Menu_F1_E3[3]);
                                              uart_printf("alarm is rigister success \r\n");
              #endif                                  
 579   5                                      delay10ms();
 580   5                                      if (Two_Menu_F1_E3[3] == 9)
 581   5                                      {
 582   6                                              if (Two_Menu_F1_E3[2] == 9)
 583   6                                              {
 584   7                                                      if (Two_Menu_F1_E3[1] == 9)
 585   7                                                      {
 586   8                                                              Two_Menu_F1_E3[0]++;
 587   8                                                              Two_Menu_F1_E3[1] = 0;
 588   8                                                              Two_Menu_F1_E3[2] = 0;
 589   8                                                              if (Two_Menu_F1_E3[0] == 21)
 590   8                                                              {
 591   9                                                                      Two_Menu_F1_E3[0] = 0;
 592   9                                                                      Two_Menu_F1_E3[3] = 1;
 593   9                                                              }
 594   8                                                              else
 595   8                                                              {
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 11  

 596   9                                                                      Two_Menu_F1_E3[3] = 1;
 597   9                                                              }
 598   8                                                      }
 599   7                                                      else
 600   7                                                      {
 601   8                                                              Two_Menu_F1_E3[1]++;
 602   8                                                              Two_Menu_F1_E3[2] = 0;
 603   8                                                              Two_Menu_F1_E3[3] = 0;
 604   8                                                      }
 605   7                                              }
 606   6                                              else
 607   6                                              {
 608   7                                                      Two_Menu_F1_E3[2]++;
 609   7                                                      Two_Menu_F1_E3[3] = 0;
 610   7                                              }
 611   6                                      }
 612   5                                      else
 613   5                                              Two_Menu_F1_E3[3]++;
 614   5                              }
 615   4                              break;
 616   4                      }
 617   3                      case TWO_MENU_F1_E4_D1:
 618   3                      case TWO_MENU_F1_E4_D2:
 619   3                      case TWO_MENU_F1_E4_D3:
 620   3                      case TWO_MENU_F1_E4_D4:
 621   3                      {
 622   4                              set_func_index(TWO_MENU_F1_E4_D4);
 623   4      
 624   4                              memcpy(tmp.region, Two_Menu_F1_E4, 4);
 625   4                              tmp.rf = ((uint32_t)old2_RF_RECE_REG[0]) << 16 | ((uint32_t)old2_RF_RECE_REG[1]) << 8 | ((uint32_t)old2
             -_RF_RECE_REG[2]);
 626   4      
 627   4      
 628   4                              if (!register_cancel_function(&tmp))// ˝÷µ◊‘∂Øº”1
 629   4                              {
 630   5      #ifdef DEBUG
                                              uart_printf("cancel is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6]
             -, (unsigned int)buf_eeprom[7]); //≤‚ ‘∞¥º¸º¸÷µ
                                              uart_printf("cancel is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E4[0], (unsigned int)Two_M
             -enu_F1_E4[1], (unsigned int)Two_Menu_F1_E4[2], (unsigned int)Two_Menu_F1_E4[3]);
                                              uart_printf("cancel is rigister success \r\n");
              #endif                                  
 635   5                                      delay10ms();
 636   5                                      if (Two_Menu_F1_E4[3] == 9)
 637   5                                      {
 638   6                                              if (Two_Menu_F1_E4[2] == 9)
 639   6                                              {
 640   7                                                      if (Two_Menu_F1_E4[1] == 9)
 641   7                                                      {
 642   8                                                              Two_Menu_F1_E4[0]++;
 643   8                                                              Two_Menu_F1_E4[1] = 0;
 644   8                                                              Two_Menu_F1_E4[2] = 0;
 645   8                                                              if (Two_Menu_F1_E4[0] == 21)
 646   8                                                              {
 647   9                                                                      Two_Menu_F1_E4[0] = 0;
 648   9                                                                      Two_Menu_F1_E4[3] = 1;
 649   9                                                              }
 650   8                                                              else
 651   8                                                              {
 652   9                                                                      Two_Menu_F1_E4[3] = 1;
 653   9                                                              }
 654   8                                                      }
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 12  

 655   7                                                      else
 656   7                                                      {
 657   8                                                              Two_Menu_F1_E4[1]++;
 658   8                                                              Two_Menu_F1_E4[2] = 0;
 659   8                                                              Two_Menu_F1_E4[3] = 0;
 660   8                                                      }
 661   7                                              }
 662   6                                              else
 663   6                                              {
 664   7                                                      Two_Menu_F1_E4[2]++;
 665   7                                                      Two_Menu_F1_E4[3] = 0;
 666   7                                              }
 667   6                                      }
 668   5                                      else
 669   5                                              Two_Menu_F1_E4[3]++;
 670   5                              }
 671   4                              break;
 672   4                      }
 673   3                      case TWO_MENU_F8_E2_SET :
 674   3                              set_sound_table(0);
 675   3                              Two_menu_set_success = 1;
 676   3                              if (Two_Menu_F8_E1_temp == 1)
 677   3                              {
 678   4                                      single_key[old2_RF_RECE_REG[2] & 0x0f] = Two_Menu_F8_E2_temp;
 679   4                                      ISendStr(I2C_ADDRESS, SIN_KEY, single_key, 16);
 680   4                              }
 681   3                              else
 682   3                              {
 683   4                                      multiple_key[old2_RF_RECE_REG[2] & 0x0f] = Two_Menu_F8_E2_temp;
 684   4                                      ISendStr(I2C_ADDRESS, MUL_KEY, multiple_key, 16);
 685   4                              }
 686   3      #ifdef DEBUG
                                      uart_printf("single_key£∫  ");
                                      for (i = 0; i < 16; i++)
                                      {
                                              
                                              uart_printf("%02d ", (unsigned int)single_key[i]);
                                      }
                                      uart_printf(" \r\n");
              
                                      uart_printf("multiple_key£∫");
                                      for (i = 0; i < 16; i++)
                                      {
              
                                              uart_printf("%2d ", (unsigned int)multiple_key[i]);
                                      }
                                      uart_printf(" \r\n");
              #endif  
 703   3      
 704   3                              break;
 705   3      
 706   3      
 707   3                      default:break;//ƒ¨»œµƒbreak
 708   3                      }
 709   2                      clear_again_receive_rf_decoder_finished();//«Â≥˝±Í÷æŒª
 710   2              }
 711   1              
 712   1              LogoutProcess();
 713   1              CycleProcess();
 714   1      }
*** WARNING C280 IN LINE 22 OF RECEIVER\DECODER.C: 'i': unreferenced local variable
*** WARNING C280 IN LINE 22 OF RECEIVER\DECODER.C: 'j': unreferenced local variable
C51 COMPILER V9.00   DECODER                                                               11/05/2015 14:58:07 PAGE 13  

 715          
 716          unsigned char return_Two_menu_set_success(void)
 717          {
 718   1              unsigned char temp = 0;
 719   1              temp = Two_menu_set_success;
 720   1              return temp;
 721   1      }
 722          
 723          void set_Two_menu_set_success(unsigned char temp)
 724          {
 725   1              Two_menu_set_success = temp;
 726   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3605    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     13      43
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
