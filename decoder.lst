C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE DECODER
OBJECT MODULE PLACED IN decoder.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Receiver\decoder.c LARGE BROWSE INCDIR(.\Receiver) DEBUG OBJECTEXTEND PRINT
                    -(.\decoder.lst) OBJECT(decoder.obj)

line level    source

   1          #include "decoder.h"
   2          #include "ev1527.h"
   3          #include "usart.h"
   4          #include "at24c256.h"
   5          #include "key.h"
   6          #include "menu.h"
   7          #include "tm1629.h"
   8          #include "timer.h"
   9          #include "gd5800.h"
  10          
  11          unsigned char buf_eeprom[8] = { 0 };//Ð´ÈëEEPROM_buf
  12          
  13          void DecoderProcess(void)
  14          {       
  15   1              unsigned char i, j ,l ,k;
  16   1              unsigned char temp_buff[8];//½âÂëÓÃÁÙÊ±Êý×é
  17   1              unsigned char temp_buff1[PAGE_LENGTH] = { 0 };//²éÑ¯AT24C256ÁÙÊ±Êý×é
  18   1      
  19   1              unsigned char func_index_temp = 0;              //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  20   1              unsigned char Two_Menu_F8_E1_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  21   1              unsigned char Two_Menu_F8_E2_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  22   1              unsigned char Two_Menu_F3_E1_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿    
  23   1              unsigned char Two_Menu_F3_E2_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  24   1              unsigned char Two_Menu_F7_E1_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  25   1              unsigned char Two_Menu_F6_E1_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  26   1              unsigned char Two_Menu_F6_E2_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  27   1      
  28   1              func_index_temp = return_func_index();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  29   1              Two_Menu_F8_E1_temp = return_Two_Menu_F8_E1();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  30   1              Two_Menu_F8_E2_temp = return_Two_Menu_F8_E2();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  31   1              Two_Menu_F3_E1_temp = return_Two_Menu_F3_E1();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  32   1              Two_Menu_F3_E2_temp = return_Two_Menu_F3_E2();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  33   1              Two_Menu_F7_E1_temp = return_Two_Menu_F7_E1();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  34   1              Two_Menu_F6_E1_temp = return_Two_Menu_F6_E1();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  35   1              Two_Menu_F6_E2_temp = return_Two_Menu_F6_E2();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  36   1      
  37   1              receive_rf_decoder();   //½âÂëº¯Êý
  38   1      
  39   1              if (return_again_receive_rf_decoder_finished() == 1) //±êÖ¾Î»µÈÓÚ1 ËµÃ÷ÔÚ2´Î¼ìÑéÏÂÍ¨¹ý,½ÓÊÕµ½ÓÐÐ§Âë
  40   1              {
  41   2      #ifdef DEBUG
                              uart_printf("decoder_val is %02x %02x %02x .\r\n", (unsigned int)old2_RF_RECE_REG[0], (unsigned int)old2
             -_RF_RECE_REG[1], (unsigned int)old2_RF_RECE_REG[2]); //²âÊÔ°´¼ü¼üÖµ
              #endif
  44   2                      switch (func_index_temp)
  45   2                      {
  46   3                      case MENU_STANDBY://´ý»ú×´Ì¬ÏÂ
  47   3                      {
  48   4                              set_logout_cycle_table(0);//Ñ­»·¸úÏúºÅÖØÐÂ¼ÆÊý
  49   4                              //¼üÅÌ¹æÔò
  50   4                              if ((old2_RF_RECE_REG[2] & 0xf0) == 0x00 && (((old2_RF_RECE_REG[0] >> 4) == Two_Menu_F7_E1_temp) || (Tw
             -o_Menu_F7_E1_temp == 10)))//¼üÅÌ¹æÔò£¬³ÌÐò°´Ä¬ÈÏµÄÀ´±à
  51   4                              {
  52   5                                      if (Two_Menu_F8_E1_temp == 1)  //Îª°´¼üÖµ
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 2   

  53   5                                      {
  54   6                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f] ;
  55   6                                      }
  56   5                                      else
  57   5                                      {
  58   6                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
  59   6                                      }   
  60   5                                      temp_buff[1] = old2_RF_RECE_REG[0] >> 4;        //Îª·ÀÇøºÅ
  61   5                                      temp_buff[2] = old2_RF_RECE_REG[0] & 0x0f;      //Îª3Î»×éÂëµÚÒ»Î»
  62   5                                      temp_buff[3] = old2_RF_RECE_REG[1] >> 4;        //Îª3Î»×éÂëµÚ¶þÎ»
  63   5                                      temp_buff[4] = old2_RF_RECE_REG[1] & 0x0f;      //Îª3Î»×éÂëµÚÈýÎ»
  64   5                                      temp_buff[5] = old2_RF_RECE_REG[0];                     //±¸ÓÃÏî,ÔÝÇÒ´æµÚ1Î»IDÂë
  65   5                                      temp_buff[6] = old2_RF_RECE_REG[1];                     //±¸ÓÃÏî,ÔÝÇÒ´æµÚ2Î»IDÂë
  66   5                                      temp_buff[7] = old2_RF_RECE_REG[2];                     //±¸ÓÃÏî,ÔÝÇÒ´æµÚ3Î»IDÂë
  67   5      
  68   5                                      if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
  69   5                                      {
  70   6                                              for (l = 0; l < Two_Menu_F6_E2_temp; l++)
  71   6                                              {
  72   7                                                      submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
  73   7                                              }
  74   6                                      }
  75   5                                      else
  76   5                                      {
  77   6                                              Cancel_funtion(temp_buff,display_ram);//È¡Ïûº¯Êý
  78   6                                              tm1629_load();
  79   6                                              display();
  80   6                                              break;
  81   6                                      }               
  82   5      
  83   5                                      tm1629_clear();//ÇåÆÁ
  84   5                                      decoder_temp_to_mcuram(display_ram, temp_buff);//½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×é 8×Ö½Ú×ª6×Ö½Ú
  85   5                                      tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
  86   5                                      display();//ÏÔÊ¾ÊýÂë¹Ü
  87   5                                      set_func_index(DECODER_MENU);//´ËÊ±ÌøÈë½âÂë²Ëµ¥£¬ÎªÏÂÒ»´Î½âÂë×ö×¼±¸
  88   5                                      //clear_again_receive_rf_decoder_finished();//Çå³ý½âÂëÍê³É±êÖ¾Î»
  89   5      
  90   5                                      break;
  91   5                              }
  92   4                              //ºô½ÐÆ÷×¢²á,ËÑË÷ËùÐèÒªµÄºô½ÐÆ÷
  93   4                               for (j = 0; j<(CALL_TABLE_NUMBER + CANCEL_TABLE_NUMBER + ALARM_TABLE_NUMBER); j++)//ËÑË÷±êÖ¾Î»
  94   4                              {
  95   5                                      IRcvStr(I2C_ADDRESS, j*PAGE_LENGTH, temp_buff1, PAGE_LENGTH);//¶Á³ö32¸ö×Ö½Ú±êÖ¾Î»
  96   5                                      delay10ms();
  97   5      //                              uart_printf("j = %02x \r\n",(unsigned int)j);
  98   5                                      for (i = 0; i<PAGE_LENGTH; i++) //¶Ô¶Á³öµÄ32×Ö½Ú±êÖ¾Î»½øÐÐ²é¿´£¬¿´ÊÇ·ñÎª0
  99   5                                      {
 100   6                                              if (temp_buff1[i] == 0)//±êÖ¾Î»Îª0´ú±í¸Ã±êÖ¾Î»Ëù¶ÔÓ¦µÄÊý¾ÝÇøÓÐÊý¾Ý
 101   6                                              {       
 102   7      #ifdef DEBUG
                                                              uart_printf("·¢ÏÖÒ»¸ö±êÖ¾Î» \r\n");
              #endif
 105   7                                                      IRcvStr(I2C_ADDRESS, CALL_DATA_START + (j * 32 + i) * 8, temp_buff, 8);//¶Á³ö¶ÔÓ¦µÄ8¸ö×Ö½ÚµÄÊý¾Ý
 106   7                                                      delay10ms();
 107   7                                                      if (((Two_Menu_F8_E1_temp != 1) && temp_buff[5] == old2_RF_RECE_REG[0] && temp_buff[6] == old2_RF_RE
             -CE_REG[1] && ((temp_buff[7] >> 4) == (old2_RF_RECE_REG[2] >> 4))) || ((Two_Menu_F8_E1_temp == 1) && temp_buff[5] == old2
             -_RF_RECE_REG[0] && temp_buff[6] == old2_RF_RECE_REG[1] && temp_buff[7] == old2_RF_RECE_REG[2]))// ½øÐÐ¶Ô±È£¬¿´¿´Êý¾ÝÊÇ·ñ
             -·ûºÏ
 108   7                                                      {
 109   8      #ifdef DEBUG
                                                                      uart_printf("¶ÔÂë³É¹¦ \r\n");
                                                                      uart_printf("Ò£¿ØÆ÷ÂëÊÇ %02x %02x %02x.\r\n", (unsigned int)old2_RF_RECE_REG[0], (unsigned int)old2
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 3   

             -_RF_RECE_REG[1], (unsigned int)old2_RF_RECE_REG[2]); //²âÊÔ°´¼ü¼üÖµ
                                                                      uart_printf("±êÖ¾µØÖ·Îª %x ! \n\r", (unsigned int)(j*PAGE_LENGTH+i));
                                                                      uart_printf("´æ´¢µØÖ·Îª %x ! \n\r", CALL_DATA_START + (j * 32 + i) * 8);
              #endif
 115   8                                                              temp_buff[7] = old2_RF_RECE_REG[2];
 116   8                                                              if (temp_buff[0] < 50)
 117   8                                                              {
 118   9      #ifdef DEBUG
                                                                              uart_printf("temp_buff[0] < 50 \r\n");
              #endif
 121   9                                                                      if (Two_Menu_F8_E1_temp == 1)  //Îª°´¼üÖµ
 122   9                                                                      {
 123  10      
 124  10                                                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 125  10                                                                      }
 126   9                                                                      else
 127   9                                                                      {
 128  10      
 129  10                                                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 130  10                                                                      }
 131   9                                                              }
 132   8      #ifdef DEBUG
                                                                      uart_printf("cancen funtion \r\n");
              #endif
 135   8                                                              //ÓïÒôº¯Êý
 136   8                                                              if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 137   8                                                              {
 138   9      #ifdef DEBUG
                                                                              uart_printf("cancen funtion fault \r\n");
              #endif
 141   9                                                                      for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 142   9                                                                      {
 143  10                                                                              submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 144  10                                                                      }
 145   9                                                              }
 146   8                                                              else
 147   8                                                              {
 148   9      #ifdef DEBUG
                                                                              uart_printf("cancen funtion success \r\n");
              #endif
 151   9                                                                      Cancel_funtion(temp_buff, display_ram);//È¡Ïûº¯Êý
 152   9                                                                      tm1629_load();
 153   9                                                                      display();
 154   9                                                                      break;
 155   9                                                                      break;
 156   9                                                              }
 157   8      
 158   8                                                                      tm1629_clear();//ÇåÆÁ
 159   8                                                                      decoder_temp_to_mcuram(display_ram, temp_buff);//Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×é 
             -8×Ö½Ú×ª6×Ö½Ú
 160   8                                                                      tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 161   8                                                                      display();//ÏÔÊ¾ÊýÂë¹Ü
 162   8      #ifdef DEBUG
                                                                              uart_printf("decoder success!"); 
              #endif
 165   8      
 166   8                                                                      set_func_index(DECODER_MENU);;//´ËÊ±ÌøÈë½âÂë²Ëµ¥£¬ÎªÏÂÒ»´Î½âÂë×ö×¼±¸
 167   8                                                                      clear_again_receive_rf_decoder_finished();//Çå³ý½âÂëÍê³É±êÖ¾Î»
 168   8                                                                      break;
 169   8                                                                      break;
 170   8                                                      }
 171   7                                              }
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 4   

 172   6                                      }
 173   5                              }       
 174   4                               break;
 175   4                      }
 176   3      
 177   3                      case DECODER_MENU: //½âÂë²Ëµ¥ÏÂ
 178   3                      {
 179   4                              set_logout_cycle_table(0);//Ñ­»·¸úÏúºÅÖØÐÂ¼ÆÊý
 180   4                               //¼üÅÌ¹æÔò
 181   4                              if ((old2_RF_RECE_REG[2] & 0xf0) == 0x00 && (((old2_RF_RECE_REG[0] >> 4) == Two_Menu_F7_E1_temp) || (Tw
             -o_Menu_F7_E1_temp == 10)))//¼üÅÌ¹æÔò£¬³ÌÐò°´Ä¬ÈÏµÄÀ´±à
 182   4                              {
 183   5                                      if (Two_Menu_F8_E1_temp == 1)  //Îª°´¼üÖµ
 184   5                                      {
 185   6                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 186   6                                      }
 187   5                                      else
 188   5                                      {
 189   6                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 190   6                                      }
 191   5                                      temp_buff[1] = old2_RF_RECE_REG[0] >> 4;        //Îª·ÀÇøºÅ
 192   5                                      temp_buff[2] = old2_RF_RECE_REG[0] & 0x0f;      //Îª3Î»×éÂëµÚÒ»Î»
 193   5                                      temp_buff[3] = old2_RF_RECE_REG[1] >> 4;        //Îª3Î»×éÂëµÚ¶þÎ»
 194   5                                      temp_buff[4] = old2_RF_RECE_REG[1] & 0x0f;      //Îª3Î»×éÂëµÚÈýÎ»
 195   5                                      temp_buff[5] = old2_RF_RECE_REG[0];                     //±¸ÓÃÏî,ÔÝÇÒ´æµÚÒ»Î»IDÂë
 196   5                                      temp_buff[6] = old2_RF_RECE_REG[1];                     //±¸ÓÃÏî,ÔÝÇÒ´æµÚ¶þÎ»IDÂë
 197   5                                      temp_buff[7] = old2_RF_RECE_REG[2];                     //±¸ÓÃÏî,ÔÝÇÒ´æµÚÈýÎ»IDÂë
 198   5                                      if (Two_Menu_F3_E1_temp == 1)                           //Îª¼´Ê±Ä£Ê½
 199   5                                      {       
 200   6                                              if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 201   6                                              {
 202   7                                                      for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 203   7                                                      {
 204   8                                                              submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 205   8                                                      }
 206   7                                              }
 207   6                                              else
 208   6                                              {
 209   7                                                      Cancel_funtion(temp_buff, display_ram);//È¡Ïûº¯Êý
 210   7                                                      tm1629_load();
 211   7                                                      display();
 212   7                                                      break;
 213   7                                              }
 214   6      
 215   6                                              if (display_ram[1] == temp_buff[1] && display_ram[2] == temp_buff[2] && display_ram[3] == temp_buff[3
             -] && display_ram[4] == temp_buff[4])
 216   6                                              {
 217   7                                                      decoder_temp_to_mcuram(display_ram, temp_buff);
 218   7                                              }
 219   6                                              else
 220   6                                              {
 221   7                                                      for (l = Two_Menu_F3_E2_temp; l>1; l--) //ÕûÌåÍùÏÂÒÆÒ»×éÊý¾Ý
 222   7                                                      {
 223   8                                                              mcuram_to_mcuram_down(display_ram + (l - 2) * 6);
 224   8                                                      }
 225   7                                                      for (l = 0; l<6; l++) //½²µÚÒ»×éÊý¾ÝÇå0
 226   7                                                      {
 227   8                                                              display_ram[l] = 0;
 228   8                                                      }
 229   7                                                      decoder_temp_to_mcuram(display_ram, temp_buff); //Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×é 8
             -×Ö½Ú×ª6×Ö½Ú
 230   7                                              }                       
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 5   

 231   6                                              tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 232   6                                              display();//ÏÔÊ¾ÊýÂë¹Ü
 233   6                                      }
 234   5                                      else if (Two_Menu_F3_E1_temp == 2)//ÎªÑ­»·Ä£Ê½
 235   5                                      {
 236   6                                              for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 237   6                                              {
 238   7                                                      if (display_ram[k * 6] == 0)//ÕÒ³öÎ»ÓÚ¶ÓÁÐ×îºóµÄÄÇ¸öµã
 239   7                                                      {
 240   8                                                              if (display_ram[(k - 1) * 6 + 1] == temp_buff[1] && display_ram[(k - 1) * 6 + 2] == temp_buff[2] &&
             - display_ram[(k - 1) * 6 + 3] == temp_buff[3] && display_ram[(k - 1) * 6 + 4] == temp_buff[4])
 241   8                                                              {
 242   9                                                                      decoder_temp_to_mcuram(display_ram + (k-1) * 6, temp_buff);
 243   9                                                              }
 244   8                                                              else
 245   8                                                              {
 246   9                                                                      decoder_temp_to_mcuram(display_ram + k * 6, temp_buff);//Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔ
             -Ý´æÊý×é 8×Ö½Ú×ª6×Ö½Ú
 247   9                                                              }       
 248   8                                                              tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 249   8                                                              display();//ÏÔÊ¾ÊýÂë¹Ü
 250   8                                                              break;
 251   8                                                      }
 252   7                                              }
 253   6      
 254   6                                      }
 255   5                                      //clear_again_receive_rf_decoder_finished();//Çå³ý½âÂëÍê³É±êÖ¾Î»
 256   5                                      break;
 257   5                              }
 258   4                              //ºô½ÐÆ÷×¢²á,ËÑË÷ËùÐèÒªµÄºô½ÐÆ÷
 259   4                              for (j = 0; j<CALL_TABLE_NUMBER + ALARM_TABLE_NUMBER + CANCEL_TABLE_NUMBER; j++)//ËÑË÷±êÖ¾Î»
 260   4                              {
 261   5                                      IRcvStr(I2C_ADDRESS, j*PAGE_LENGTH, temp_buff1, PAGE_LENGTH);//¶Á³ö32¸ö×Ö½Ú±êÖ¾Î»
 262   5                                      delay10ms();
 263   5                                      for (i = 0; i<PAGE_LENGTH; i++)
 264   5                                      {
 265   6                                              if (temp_buff1[i] == 0)//¶Ô¶Á³öµÄ32×Ö½Ú±êÖ¾Î»½øÐÐ²é¿´£¬¿´ÊÇ·ñÎª0
 266   6                                              {
 267   7                                                      IRcvStr(I2C_ADDRESS, CALL_DATA_START + (j * 32 + i) * 8, temp_buff, 8);//¶Á³ö¶ÔÓ¦µÄ8¸ö×Ö½ÚµÄÊý¾Ý
 268   7                                                      delay10ms();
 269   7                                                      if (((Two_Menu_F8_E1_temp != 1) && temp_buff[5] == old2_RF_RECE_REG[0] && temp_buff[6] == old2_RF_RE
             -CE_REG[1] && ((temp_buff[7] >> 4) == (old2_RF_RECE_REG[2] >> 4))) || ((Two_Menu_F8_E1_temp == 1) && temp_buff[5] == old2
             -_RF_RECE_REG[0] && temp_buff[6] == old2_RF_RECE_REG[1] && temp_buff[7] == old2_RF_RECE_REG[2]))
 270   7                                                      {
 271   8      #ifdef DEBUG
                                                                      uart_printf("ÄãºÃ \r\n");
              #endif
 274   8                                                              temp_buff[7] = old2_RF_RECE_REG[2];
 275   8                                                              if (temp_buff[0] < 50)
 276   8                                                              {
 277   9                                                                      if (Two_Menu_F8_E1_temp == 1)  //Îª°´¼üÖµ
 278   9                                                                      {
 279  10      
 280  10                                                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 281  10                                                                      }
 282   9                                                                      else
 283   9                                                                      {
 284  10      
 285  10                                                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 286  10                                                                      }
 287   9                                                              }
 288   8                              
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 6   

 289   8                                                              if (Two_Menu_F3_E1_temp == 1)//Îª¼´Ê±Ä£Ê½
 290   8                                                              {
 291   9      
 292   9                                                                      if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 293   9                                                                      {
 294  10      #ifdef DEBUG
                                                                                      uart_printf("cancen funtion fault \r\n");
              #endif
 297  10                                                                              for (l = 0; l < Two_Menu_F6_E2_temp; l++)
 298  10                                                                              {
 299  11                                                                                      submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 300  11                                                                              }
 301  10                                                                      }
 302   9                                                                      else
 303   9                                                                      {
 304  10      #ifdef DEBUG
                                                                                      uart_printf("cancen funtion success \r\n");
              #endif
 307  10                                                                              Cancel_funtion(temp_buff, display_ram);//È¡Ïûº¯Êý
 308  10                                                                              tm1629_load();
 309  10                                                                              display();
 310  10                                                                              break;
 311  10                                                                              break;
 312  10                                                                      }
 313   9      
 314   9                                                                      if (display_ram[1] == temp_buff[1] && display_ram[2] == temp_buff[2] && display_ram[3] == temp_buf
             -f[3] && display_ram[4] == temp_buff[4])
 315   9                                                                      {
 316  10                                                                              decoder_temp_to_mcuram(display_ram, temp_buff);
 317  10                                                                      }
 318   9                                                                      else
 319   9                                                                      {
 320  10                                                                              for (l = Two_Menu_F3_E2_temp; l>1; l--) //ÕûÌåÍùÏÂÒÆÒ»×éÊý¾Ý
 321  10                                                                              {
 322  11                                                                                      mcuram_to_mcuram_down(display_ram + (l - 2) * 6);
 323  11                                                                              }
 324  10                                                                              for (l = 0; l<6; l++) //½²µÚÒ»×éÊý¾ÝÇå0
 325  10                                                                              {
 326  11                                                                                      display_ram[l] = 0;
 327  11                                                                              }
 328  10                                                                              decoder_temp_to_mcuram(display_ram, temp_buff); //Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×
             -é 8×Ö½Ú×ª6×Ö½Ú
 329  10                                                                      }
 330   9                                                                      tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 331   9                                                                      display();//ÏÔÊ¾ÊýÂë¹Ü
 332   9                                                              }
 333   8                                                      else if (Two_Menu_F3_E1_temp == 2)//ÎªÑ­»·Ä£Ê½
 334   8                                                      {
 335   9                                                              for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 336   9                                                              {
 337  10                                                                      if (display_ram[k * 6 ] == 0)//ÕÒ³öÎ»ÓÚ¶ÓÁÐ×îºóµÄÄÇ¸öµã
 338  10                                                                      {
 339  11                                                                              if (display_ram[(k - 1) * 6 + 1] == temp_buff[1] && display_ram[(k - 1) * 6 + 2] == temp_buff[2] 
             -&& display_ram[(k - 1) * 6 + 3] == temp_buff[3] && display_ram[(k - 1) * 6 + 4] == temp_buff[4])
 340  11                                                                              {
 341  12                                                                                      decoder_temp_to_mcuram(display_ram + (k - 1) * 6, temp_buff);
 342  12                                                                              }
 343  11                                                                              else
 344  11                                                                              {
 345  12                                                                                      decoder_temp_to_mcuram(display_ram + k * 6, temp_buff);//Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»
             -úÔÝ´æÊý×é 8×Ö½Ú×ª6×Ö½Ú
 346  12                                                                              }
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 7   

 347  11                                                                              tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 348  11                                                                              display();//ÏÔÊ¾ÊýÂë¹Ü
 349  11                                                                              break;
 350  11                                                                      }
 351  10                                                              }
 352   9                                                      }
 353   8      #ifdef DEBUG
                                                                      uart_printf("decoder success!");
              #endif
 356   8      
 357   8      #ifdef DEBUG
                                                                      uart_printf("display_ram is %02x %02x %02x %02x.\r\n", (unsigned int)display_ram[0], (unsigned int)
             -display_ram[1], (unsigned int)display_ram[2], (unsigned int)display_ram[3]); //²âÊÔ°´¼ü¼üÖµ
              #endif
 360   8                                                              clear_again_receive_rf_decoder_finished();
 361   8                                                              break;
 362   8                                                              break;
 363   8                                                      }
 364   7                                              }
 365   6                                      }
 366   5                              }
 367   4                              break;
 368   4                      }
 369   3      
 370   3                      case TWO_MENU_F1_E1_D1:
 371   3                      case TWO_MENU_F1_E1_D2:
 372   3                      case TWO_MENU_F1_E1_D3:
 373   3                      case TWO_MENU_F1_E1_D4:
 374   3                      {
 375   4                              set_func_index(TWO_MENU_F1_E1_D4);
 376   4                              buf_eeprom[0] = old2_RF_RECE_REG[2] & 0x0f;//°´¼üÖµ±£´æµ½0×Ö½Ú
 377   4                              buf_eeprom[1] = Two_Menu_F1_E1[0];/*ÊýÖµ´æÈë1 2 3 4×Ö½Ú*/
 378   4                              buf_eeprom[2] = Two_Menu_F1_E1[1];
 379   4                              buf_eeprom[3] = Two_Menu_F1_E1[2];
 380   4                              buf_eeprom[4] = Two_Menu_F1_E1[3];
 381   4                              buf_eeprom[5] = old2_RF_RECE_REG[0];// IDÂë´æÈë 5 6 7 ×Ö½Ú
 382   4                              buf_eeprom[6] = old2_RF_RECE_REG[1];
 383   4                              if (Two_Menu_F8_E1_temp == 1)
 384   4                              {
 385   5                                      buf_eeprom[7] = old2_RF_RECE_REG[2];
 386   5                              }
 387   4                              else
 388   4                              {
 389   5                                      buf_eeprom[7] = old2_RF_RECE_REG[2] & 0xf0;
 390   5                              }
 391   4      
 392   4                              if (register_call_function(buf_eeprom))//ÊýÖµ×Ô¶¯¼Ó1
 393   4                              {
 394   5      #ifdef DEBUG
                                              uart_printf("call is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6], 
             -(unsigned int)buf_eeprom[7]); //²âÊÔ°´¼ü¼üÖµ
                                              uart_printf("call is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E1[0], (unsigned int)Two_Men
             -u_F1_E1[1], (unsigned int)Two_Menu_F1_E1[2], (unsigned int)Two_Menu_F1_E1[3]);
                                              uart_printf("caller is rigister success \r\n");
              #endif                                  
 399   5                                      delay10ms();
 400   5                                      if (Two_Menu_F1_E1[3] == 9)
 401   5                                      {
 402   6                                              if (Two_Menu_F1_E1[2] == 9)
 403   6                                              {
 404   7                                                      if (Two_Menu_F1_E1[1] == 9)
 405   7                                                      {
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 8   

 406   8                                                              Two_Menu_F1_E1[0]++;
 407   8                                                              Two_Menu_F1_E1[1] = 0;
 408   8                                                              Two_Menu_F1_E1[2] = 0;
 409   8                                                              if (Two_Menu_F1_E1[0] == 21)
 410   8                                                              {
 411   9                                                                      Two_Menu_F1_E1[0] = 0;
 412   9                                                                      Two_Menu_F1_E1[3] = 1;
 413   9                                                              }
 414   8                                                              else
 415   8                                                              {
 416   9                                                                      Two_Menu_F1_E1[3] = 1;
 417   9                                                              }
 418   8                                                      }
 419   7                                                      else
 420   7                                                      {
 421   8                                                              Two_Menu_F1_E1[1]++;
 422   8                                                              Two_Menu_F1_E1[2] = 0;
 423   8                                                              Two_Menu_F1_E1[3] = 0;
 424   8                                                      }
 425   7                                              }
 426   6                                              else
 427   6                                              {
 428   7                                                      Two_Menu_F1_E1[2]++;
 429   7                                                      Two_Menu_F1_E1[3] = 0;
 430   7                                              }
 431   6                                      }
 432   5                                      else
 433   5                                              Two_Menu_F1_E1[3]++;
 434   5                              }
 435   4                              break;
 436   4                      }
 437   3      
 438   3                      case TWO_MENU_F1_E2_D1:
 439   3                      case TWO_MENU_F1_E2_D2:
 440   3                      case TWO_MENU_F1_E2_D3:
 441   3                      case TWO_MENU_F1_E2_D4:
 442   3                      {
 443   4                                                                        set_func_index(TWO_MENU_F1_E2_D4);
 444   4                                                                        buf_eeprom[0] = old2_RF_RECE_REG[2] & 0x0f;//°´¼üÖµ±£´æµ½0×Ö½Ú
 445   4                                                                        buf_eeprom[1] = Two_Menu_F1_E2[0];/*ÊýÖµ´æÈë1 2 3 4×Ö½Ú*/
 446   4                                                                        buf_eeprom[2] = Two_Menu_F1_E2[1];
 447   4                                                                        buf_eeprom[3] = Two_Menu_F1_E2[2];
 448   4                                                                        buf_eeprom[4] = Two_Menu_F1_E2[3];
 449   4                                                                        buf_eeprom[5] = old2_RF_RECE_REG[0];// IDÂë´æÈë 5 6 7 ×Ö½Ú
 450   4                                                                        buf_eeprom[6] = old2_RF_RECE_REG[1];
 451   4                                                                        buf_eeprom[7] = old2_RF_RECE_REG[2] & 0xf0;
 452   4      
 453   4                                                                        if (register_host_function(buf_eeprom))//ÊýÖµ×Ô¶¯¼Ó1
 454   4                                                                        {
 455   5      #ifdef DEBUG
                                                                                        uart_printf("host is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eepr
             -om[6], (unsigned int)buf_eeprom[7]); //²âÊÔ°´¼ü¼üÖµ
                                                                                        uart_printf("host is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E2[0], (unsigned int)
             -Two_Menu_F1_E2[1], (unsigned int)Two_Menu_F1_E2[2], (unsigned int)Two_Menu_F1_E2[3]);
                                                                                        uart_printf("host is rigister success \r\n");
              #endif                                  
 460   5                                                                                delay10ms();
 461   5                                                                                if (Two_Menu_F1_E2[3] == 9)
 462   5                                                                                {
 463   6                                                                                        if (Two_Menu_F1_E2[2] == 9)
 464   6                                                                                        {
 465   7                                                                                                if (Two_Menu_F1_E2[1] == 9)
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 9   

 466   7                                                                                                {
 467   8                                                                                                        Two_Menu_F1_E2[0]++;
 468   8                                                                                                        Two_Menu_F1_E2[1] = 0;
 469   8                                                                                                        Two_Menu_F1_E2[2] = 0;
 470   8                                                                                                        if (Two_Menu_F1_E2[0] == 21)
 471   8                                                                                                        {
 472   9                                                                                                                Two_Menu_F1_E2[0] = 0;
 473   9                                                                                                                Two_Menu_F1_E2[3] = 1;
 474   9                                                                                                        }
 475   8                                                                                                        else
 476   8                                                                                                        {
 477   9                                                                                                                Two_Menu_F1_E2[3] = 1;
 478   9                                                                                                        }
 479   8      
 480   8      
 481   8                                                                                                }
 482   7                                                                                                else
 483   7                                                                                                {
 484   8                                                                                                        Two_Menu_F1_E2[1]++;
 485   8                                                                                                        Two_Menu_F1_E2[2] = 0;
 486   8                                                                                                        Two_Menu_F1_E2[3] = 0;
 487   8                                                                                                }
 488   7                                                                                        }
 489   6                                                                                        else
 490   6                                                                                        {
 491   7                                                                                                Two_Menu_F1_E2[2]++;
 492   7                                                                                                Two_Menu_F1_E2[3] = 0;
 493   7                                                                                        }
 494   6                                                                                }
 495   5                                                                                else
 496   5                                                                                        Two_Menu_F1_E2[3]++;
 497   5                                                                        }
 498   4                                                                        break;
 499   4                      }
 500   3      
 501   3                      case TWO_MENU_F1_E3_D1:
 502   3                      case TWO_MENU_F1_E3_D2:
 503   3                      case TWO_MENU_F1_E3_D3:
 504   3                      case TWO_MENU_F1_E3_D4:
 505   3                      {
 506   4                              set_func_index(TWO_MENU_F1_E3_D4);
 507   4                              buf_eeprom[0] = BAOJING_1;//°´¼üÖµ±£´æµ½0×Ö½Ú
 508   4                              buf_eeprom[1] = Two_Menu_F1_E3[0];/*ÊýÖµ´æÈë1 2 3 4×Ö½Ú*/
 509   4                              buf_eeprom[2] = Two_Menu_F1_E3[1];
 510   4                              buf_eeprom[3] = Two_Menu_F1_E3[2];
 511   4                              buf_eeprom[4] = Two_Menu_F1_E3[3];
 512   4                              buf_eeprom[5] = old2_RF_RECE_REG[0];// IDÂë´æÈë 5 6 7 ×Ö½Ú
 513   4                              buf_eeprom[6] = old2_RF_RECE_REG[1];
 514   4                              buf_eeprom[7] = old2_RF_RECE_REG[2] & 0xf0;
 515   4      
 516   4                              if (register_alarm_function(buf_eeprom))//ÊýÖµ×Ô¶¯¼Ó1
 517   4                              {
 518   5      #ifdef DEBUG
                                              uart_printf("alarm is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6],
             - (unsigned int)buf_eeprom[7]); //²âÊÔ°´¼ü¼üÖµ
                                              uart_printf("alarm is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E3[0], (unsigned int)Two_Me
             -nu_F1_E3[1], (unsigned int)Two_Menu_F1_E3[2], (unsigned int)Two_Menu_F1_E3[3]);
                                              uart_printf("alarm is rigister success \r\n");
              #endif                                  
 523   5                                      delay10ms();
 524   5                                      if (Two_Menu_F1_E3[3] == 9)
 525   5                                      {
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 10  

 526   6                                              if (Two_Menu_F1_E3[2] == 9)
 527   6                                              {
 528   7                                                      if (Two_Menu_F1_E3[1] == 9)
 529   7                                                      {
 530   8                                                              Two_Menu_F1_E3[0]++;
 531   8                                                              Two_Menu_F1_E3[1] = 0;
 532   8                                                              Two_Menu_F1_E3[2] = 0;
 533   8                                                              if (Two_Menu_F1_E3[0] == 21)
 534   8                                                              {
 535   9                                                                      Two_Menu_F1_E3[0] = 0;
 536   9                                                                      Two_Menu_F1_E3[3] = 1;
 537   9                                                              }
 538   8                                                              else
 539   8                                                              {
 540   9                                                                      Two_Menu_F1_E3[3] = 1;
 541   9                                                              }
 542   8                                                      }
 543   7                                                      else
 544   7                                                      {
 545   8                                                              Two_Menu_F1_E3[1]++;
 546   8                                                              Two_Menu_F1_E3[2] = 0;
 547   8                                                              Two_Menu_F1_E3[3] = 0;
 548   8                                                      }
 549   7                                              }
 550   6                                              else
 551   6                                              {
 552   7                                                      Two_Menu_F1_E3[2]++;
 553   7                                                      Two_Menu_F1_E3[3] = 0;
 554   7                                              }
 555   6                                      }
 556   5                                      else
 557   5                                              Two_Menu_F1_E3[3]++;
 558   5                              }
 559   4                              break;
 560   4                      }
 561   3                      case TWO_MENU_F1_E4_D1:
 562   3                      case TWO_MENU_F1_E4_D2:
 563   3                      case TWO_MENU_F1_E4_D3:
 564   3                      case TWO_MENU_F1_E4_D4:
 565   3                      {
 566   4                              set_func_index(TWO_MENU_F1_E4_D4);
 567   4                              buf_eeprom[0] = QUXIAO_1;//°´¼üÖµ±£´æµ½0×Ö½Ú
 568   4                              buf_eeprom[1] = Two_Menu_F1_E4[0];/*ÊýÖµ´æÈë1 2 3 4×Ö½Ú*/
 569   4                              buf_eeprom[2] = Two_Menu_F1_E4[1];
 570   4                              buf_eeprom[3] = Two_Menu_F1_E4[2];
 571   4                              buf_eeprom[4] = Two_Menu_F1_E4[3];
 572   4                              buf_eeprom[5] = old2_RF_RECE_REG[0];// IDÂë´æÈë 5 6 7 ×Ö½Ú
 573   4                              buf_eeprom[6] = old2_RF_RECE_REG[1];
 574   4                              buf_eeprom[7] = old2_RF_RECE_REG[2] & 0xf0;
 575   4      
 576   4                              if (register_cancel_function(buf_eeprom))//ÊýÖµ×Ô¶¯¼Ó1
 577   4                              {
 578   5      #ifdef DEBUG
                                              uart_printf("cancel is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6]
             -, (unsigned int)buf_eeprom[7]); //²âÊÔ°´¼ü¼üÖµ
                                              uart_printf("cancel is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E4[0], (unsigned int)Two_M
             -enu_F1_E4[1], (unsigned int)Two_Menu_F1_E4[2], (unsigned int)Two_Menu_F1_E4[3]);
                                              uart_printf("cancel is rigister success \r\n");
              #endif                                  
 583   5                                      delay10ms();
 584   5                                      if (Two_Menu_F1_E4[3] == 9)
 585   5                                      {
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 11  

 586   6                                              if (Two_Menu_F1_E4[2] == 9)
 587   6                                              {
 588   7                                                      if (Two_Menu_F1_E4[1] == 9)
 589   7                                                      {
 590   8                                                              Two_Menu_F1_E4[0]++;
 591   8                                                              Two_Menu_F1_E4[1] = 0;
 592   8                                                              Two_Menu_F1_E4[2] = 0;
 593   8                                                              if (Two_Menu_F1_E4[0] == 21)
 594   8                                                              {
 595   9                                                                      Two_Menu_F1_E4[0] = 0;
 596   9                                                                      Two_Menu_F1_E4[3] = 1;
 597   9                                                              }
 598   8                                                              else
 599   8                                                              {
 600   9                                                                      Two_Menu_F1_E4[3] = 1;
 601   9                                                              }
 602   8                                                      }
 603   7                                                      else
 604   7                                                      {
 605   8                                                              Two_Menu_F1_E4[1]++;
 606   8                                                              Two_Menu_F1_E4[2] = 0;
 607   8                                                              Two_Menu_F1_E4[3] = 0;
 608   8                                                      }
 609   7                                              }
 610   6                                              else
 611   6                                              {
 612   7                                                      Two_Menu_F1_E4[2]++;
 613   7                                                      Two_Menu_F1_E4[3] = 0;
 614   7                                              }
 615   6                                      }
 616   5                                      else
 617   5                                              Two_Menu_F1_E4[3]++;
 618   5                              }
 619   4                              break;
 620   4                      }
 621   3                      case TWO_MENU_F8_E2_SET :
 622   3      
 623   3                              if (Two_Menu_F8_E1_temp == 1)
 624   3                              {
 625   4                                      single_key[old2_RF_RECE_REG[2] & 0x0f] = Two_Menu_F8_E2_temp;
 626   4                              }
 627   3                              else
 628   3                              {
 629   4                                      multiple_key[old2_RF_RECE_REG[2] & 0x0f] = Two_Menu_F8_E2_temp;
 630   4                              }
 631   3      #ifdef DEBUG
                                      uart_printf("single_key£º  ");
                                      for (i = 0; i < 16; i++)
                                      {
                                              
                                              uart_printf("%02d ", (unsigned int)single_key[i]);
                                      }
                                      uart_printf(" \r\n");
              
                                      uart_printf("multiple_key£º");
                                      for (i = 0; i < 16; i++)
                                      {
              
                                              uart_printf("%2d ", (unsigned int)multiple_key[i]);
                                      }
                                      uart_printf(" \r\n");
              #endif  
C51 COMPILER V9.00   DECODER                                                               10/15/2015 14:58:49 PAGE 12  

 648   3      
 649   3                              break;
 650   3      
 651   3      
 652   3                      default:break;//Ä¬ÈÏµÄbreak
 653   3                      }
 654   2                      clear_again_receive_rf_decoder_finished();//Çå³ý±êÖ¾Î»
 655   2              }
 656   1              
 657   1              LogoutProcess();
 658   1              CycleProcess();
 659   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3069    ----
   CONSTANT SIZE    =     32    ----
   XDATA SIZE       =      8      52
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
