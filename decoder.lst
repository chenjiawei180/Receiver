C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE DECODER
OBJECT MODULE PLACED IN decoder.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Receiver\decoder.c LARGE BROWSE INCDIR(.\Receiver) DEBUG OBJECTEXTEND PRINT
                    -(.\decoder.lst) OBJECT(decoder.obj)

line level    source

   1          #include "decoder.h"
   2          #include "ev1527.h"
   3          #include "usart.h"
   4          #include "at24c256.h"
   5          #include "key.h"
   6          #include "menu.h"
   7          #include "tm1629.h"
   8          #include "timer.h"
   9          #include "gd5800.h"
  10          
  11          unsigned char buf_eeprom[8] = { 0 };//Ð´ÈëEEPROM_buf
  12          
  13          void DecoderProcess(void)
  14          {       
  15   1              unsigned char i, j ,l ,k;
  16   1              unsigned char temp_buff[8];//½âÂëÓÃÁÙÊ±Êý×é
  17   1              unsigned char temp_buff1[PAGE_LENGTH] = { 0 };//²éÑ¯AT24C256ÁÙÊ±Êý×é
  18   1      
  19   1              unsigned char func_index_temp = 0;              //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  20   1              unsigned char Two_Menu_F8_E1_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  21   1              unsigned char Two_Menu_F8_E2_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  22   1              unsigned char Two_Menu_F3_E1_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿    
  23   1              unsigned char Two_Menu_F3_E2_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  24   1              unsigned char Two_Menu_F7_E1_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  25   1              unsigned char Two_Menu_F6_E1_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  26   1              unsigned char Two_Menu_F6_E2_temp = 0;  //´´½¨ÁÙÊ±±äÁ¿£¬ÓÃÓÚ·Å»ØÆäËûÍâ²¿±äÁ¿
  27   1      
  28   1              func_index_temp = return_func_index();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  29   1              Two_Menu_F8_E1_temp = return_Two_Menu_F8_E1();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  30   1              Two_Menu_F8_E2_temp = return_Two_Menu_F8_E2();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  31   1              Two_Menu_F3_E1_temp = return_Two_Menu_F3_E1();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  32   1              Two_Menu_F3_E2_temp = return_Two_Menu_F3_E2();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  33   1              Two_Menu_F7_E1_temp = return_Two_Menu_F7_E1();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  34   1              Two_Menu_F6_E1_temp = return_Two_Menu_F6_E1();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  35   1              Two_Menu_F6_E2_temp = return_Two_Menu_F6_E2();  //·µ»ØËùÐèÒªµÄÍâ²¿±äÁ¿
  36   1      
  37   1              receive_rf_decoder();   //½âÂëº¯Êý
  38   1      
  39   1              if (return_again_receive_rf_decoder_finished() == 1) //±êÖ¾Î»µÈÓÚ1 ËµÃ÷ÔÚ2´Î¼ìÑéÏÂÍ¨¹ý,½ÓÊÕµ½ÓÐÐ§Âë
  40   1              {
  41   2      #ifdef DEBUG
  42   2                      uart_printf("decoder_val is %02x %02x %02x .\r\n", (unsigned int)old2_RF_RECE_REG[0], (unsigned int)old2
             -_RF_RECE_REG[1], (unsigned int)old2_RF_RECE_REG[2]); //²âÊÔ°´¼ü¼üÖµ
  43   2      #endif
  44   2                      switch (func_index_temp)
  45   2                      {
  46   3                      case MENU_STANDBY://´ý»ú×´Ì¬ÏÂ
  47   3                      {
  48   4                              set_logout_cycle_table(0);//Ñ­»·¸úÏúºÅÖØÐÂ¼ÆÊý
  49   4                              //¼üÅÌ¹æÔò
  50   4                              if ((old2_RF_RECE_REG[2] & 0xf0) == 0x00 && (((old2_RF_RECE_REG[0] >> 4) == Two_Menu_F7_E1_temp) || (Tw
             -o_Menu_F7_E1_temp == 10)))//¼üÅÌ¹æÔò£¬³ÌÐò°´Ä¬ÈÏµÄÀ´±à
  51   4                              {
  52   5                                      if (Two_Menu_F8_E1_temp == 1)  //Îª°´¼üÖµ
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 2   

  53   5                                      {
  54   6                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f] ;
  55   6                                      }
  56   5                                      else
  57   5                                      {
  58   6                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
  59   6                                      }   
  60   5                                      temp_buff[1] = old2_RF_RECE_REG[0] >> 4;        //Îª·ÀÇøºÅ
  61   5                                      temp_buff[2] = old2_RF_RECE_REG[0] & 0x0f;      //Îª3Î»×éÂëµÚÒ»Î»
  62   5                                      temp_buff[3] = old2_RF_RECE_REG[1] >> 4;        //Îª3Î»×éÂëµÚ¶þÎ»
  63   5                                      temp_buff[4] = old2_RF_RECE_REG[1] & 0x0f;      //Îª3Î»×éÂëµÚÈýÎ»
  64   5                                      temp_buff[5] = old2_RF_RECE_REG[0];                     //±¸ÓÃÏî,ÔÝÇÒ´æµÚÒ»Î»IDÂë
  65   5      
  66   5                                      if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
  67   5                                      {
  68   6                                              submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
  69   6                                      }
  70   5                                      else
  71   5                                      {
  72   6                                              Cancel_funtion(temp_buff,display_ram);//È¡Ïûº¯Êý
  73   6                                              tm1629_load();
  74   6                                              display();
  75   6                                              break;
  76   6                                      }               
  77   5      
  78   5                                      tm1629_clear();//ÇåÆÁ
  79   5                                      decoder_temp_to_mcuram(display_ram, temp_buff);//½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×é 8×Ö½Ú×ª6×Ö½Ú
  80   5                                      tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
  81   5                                      display();//ÏÔÊ¾ÊýÂë¹Ü
  82   5                                      set_func_index(DECODER_MENU);//´ËÊ±ÌøÈë½âÂë²Ëµ¥£¬ÎªÏÂÒ»´Î½âÂë×ö×¼±¸
  83   5                                      //clear_again_receive_rf_decoder_finished();//Çå³ý½âÂëÍê³É±êÖ¾Î»
  84   5      
  85   5                                      break;
  86   5                              }
  87   4                              //ºô½ÐÆ÷×¢²á,ËÑË÷ËùÐèÒªµÄºô½ÐÆ÷
  88   4                               for (j = 0; j<(CALL_TABLE_NUMBER + CANCEL_TABLE_NUMBER + ALARM_TABLE_NUMBER); j++)//ËÑË÷±êÖ¾Î»
  89   4                              {
  90   5                                      IRcvStr(I2C_ADDRESS, j*PAGE_LENGTH, temp_buff1, PAGE_LENGTH);//¶Á³ö32¸ö×Ö½Ú±êÖ¾Î»
  91   5                                      delay10ms();
  92   5                                      uart_printf("j = %02x \r\n",(unsigned int)j);
  93   5                                      for (i = 0; i<PAGE_LENGTH; i++) //¶Ô¶Á³öµÄ32×Ö½Ú±êÖ¾Î»½øÐÐ²é¿´£¬¿´ÊÇ·ñÎª0
  94   5                                      {
  95   6                                              if (temp_buff1[i] == 0)//±êÖ¾Î»Îª0´ú±í¸Ã±êÖ¾Î»Ëù¶ÔÓ¦µÄÊý¾ÝÇøÓÐÊý¾Ý
  96   6                                              {       
  97   7      #ifdef DEBUG
  98   7                                                      uart_printf("·¢ÏÖÒ»¸ö±êÖ¾Î» \r\n");
  99   7      #endif
 100   7                                                      IRcvStr(I2C_ADDRESS, CALL_DATA_START + (j * 32 + i) * 8, temp_buff, 8);//¶Á³ö¶ÔÓ¦µÄ8¸ö×Ö½ÚµÄÊý¾Ý
 101   7                                                      delay10ms();
 102   7                                                      if (((Two_Menu_F8_E1_temp != 1) && temp_buff[5] == old2_RF_RECE_REG[0] && temp_buff[6] == old2_RF_RE
             -CE_REG[1] && ((temp_buff[7] >> 4) == (old2_RF_RECE_REG[2] >> 4))) || ((Two_Menu_F8_E1_temp == 1) && temp_buff[5] == old2
             -_RF_RECE_REG[0] && temp_buff[6] == old2_RF_RECE_REG[1] && temp_buff[7] == old2_RF_RECE_REG[2]))// ½øÐÐ¶Ô±È£¬¿´¿´Êý¾ÝÊÇ·ñ
             -·ûºÏ
 103   7                                                      {
 104   8      #ifdef DEBUG
 105   8                                                              uart_printf("¶ÔÂë³É¹¦ \r\n");
 106   8                                                              uart_printf("Ò£¿ØÆ÷ÂëÊÇ %02x %02x %02x.\r\n", (unsigned int)old2_RF_RECE_REG[0], (unsigned int)old2
             -_RF_RECE_REG[1], (unsigned int)old2_RF_RECE_REG[2]); //²âÊÔ°´¼ü¼üÖµ
 107   8                                                              uart_printf("±êÖ¾µØÖ·Îª %x ! \n\r", (unsigned int)(j*PAGE_LENGTH+i));
 108   8                                                              uart_printf("´æ´¢µØÖ·Îª %x ! \n\r", CALL_DATA_START + (j * 32 + i) * 8);
 109   8      #endif
 110   8                                                              if (temp_buff[0] < 50)
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 3   

 111   8                                                              {
 112   9      #ifdef DEBUG
 113   9                                                                      uart_printf("temp_buff[0] < 50 \r\n");
 114   9      #endif
 115   9                                                                      if (Two_Menu_F8_E1_temp == 1)  //Îª°´¼üÖµ
 116   9                                                                      {
 117  10      
 118  10                                                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 119  10                                                                      }
 120   9                                                                      else
 121   9                                                                      {
 122  10      
 123  10                                                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 124  10                                                                      }
 125   9                                                              }
 126   8      #ifdef DEBUG
 127   8                                                              uart_printf("cancen funtion \r\n");
 128   8      #endif
 129   8                                                              //ÓïÒôº¯Êý
 130   8                                                              if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 131   8                                                              {
 132   9      #ifdef DEBUG
 133   9                                                                      uart_printf("cancen funtion fault \r\n");
 134   9      #endif
 135   9                                                                      submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 136   9                                                              }
 137   8                                                              else
 138   8                                                              {
 139   9      #ifdef DEBUG
 140   9                                                                      uart_printf("cancen funtion success \r\n");
 141   9      #endif
 142   9                                                                      Cancel_funtion(temp_buff, display_ram);//È¡Ïûº¯Êý
 143   9                                                                      tm1629_load();
 144   9                                                                      display();
 145   9                                                                      break;
 146   9                                                                      break;
 147   9                                                              }
 148   8      
 149   8                                                                      tm1629_clear();//ÇåÆÁ
 150   8                                                                      decoder_temp_to_mcuram(display_ram, temp_buff);//Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×é 
             -8×Ö½Ú×ª6×Ö½Ú
 151   8                                                                      tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 152   8                                                                      display();//ÏÔÊ¾ÊýÂë¹Ü
 153   8      #ifdef DEBUG
 154   8                                                                      uart_printf("decoder success!"); 
 155   8      #endif
 156   8      
 157   8                                                                      set_func_index(DECODER_MENU);;//´ËÊ±ÌøÈë½âÂë²Ëµ¥£¬ÎªÏÂÒ»´Î½âÂë×ö×¼±¸
 158   8                                                                      clear_again_receive_rf_decoder_finished();//Çå³ý½âÂëÍê³É±êÖ¾Î»
 159   8                                                                      break;
 160   8                                                                      break;
 161   8                                                      }
 162   7                                              }
 163   6                                      }
 164   5                              }       
 165   4                               break;
 166   4                      }
 167   3      
 168   3                      case DECODER_MENU: //½âÂë²Ëµ¥ÏÂ
 169   3                      {
 170   4                              set_logout_cycle_table(0);//Ñ­»·¸úÏúºÅÖØÐÂ¼ÆÊý
 171   4                               //¼üÅÌ¹æÔò
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 4   

 172   4                              if ((old2_RF_RECE_REG[2] & 0xf0) == 0x00 && (((old2_RF_RECE_REG[0] >> 4) == Two_Menu_F7_E1_temp) || (Tw
             -o_Menu_F7_E1_temp == 10)))//¼üÅÌ¹æÔò£¬³ÌÐò°´Ä¬ÈÏµÄÀ´±à
 173   4                              {
 174   5                                      if (Two_Menu_F8_E1_temp == 1)  //Îª°´¼üÖµ
 175   5                                      {
 176   6                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 177   6                                      }
 178   5                                      else
 179   5                                      {
 180   6                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 181   6                                      }
 182   5                                      temp_buff[1] = old2_RF_RECE_REG[0] >> 4;        //Îª·ÀÇøºÅ
 183   5                                      temp_buff[2] = old2_RF_RECE_REG[0] & 0x0f;      //Îª3Î»×éÂëµÚÒ»Î»
 184   5                                      temp_buff[3] = old2_RF_RECE_REG[1] >> 4;        //Îª3Î»×éÂëµÚ¶þÎ»
 185   5                                      temp_buff[4] = old2_RF_RECE_REG[1] & 0x0f;      //Îª3Î»×éÂëµÚÈýÎ»
 186   5                                      temp_buff[5] = old2_RF_RECE_REG[0];                     //±¸ÓÃÏî,ÔÝÇÒ´æµÚÒ»Î»IDÂë
 187   5                                      if (Two_Menu_F3_E1_temp == 1)                           //Îª¼´Ê±Ä£Ê½
 188   5                                      {       
 189   6                                              if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 190   6                                              {
 191   7                                                      submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 192   7                                              }
 193   6                                              else
 194   6                                              {
 195   7                                                      Cancel_funtion(temp_buff, display_ram);//È¡Ïûº¯Êý
 196   7                                                      tm1629_load();
 197   7                                                      display();
 198   7                                                      break;
 199   7                                              }
 200   6      
 201   6                                              for (l = Two_Menu_F3_E2_temp; l>1; l--) //ÕûÌåÍùÏÂÒÆÒ»×éÊý¾Ý
 202   6                                              {
 203   7                                                      mcuram_to_mcuram_down(display_ram + (l - 2) * 6);
 204   7                                              }
 205   6                                              for (l = 0; l<6; l++) //½²µÚÒ»×éÊý¾ÝÇå0
 206   6                                              {
 207   7                                                      display_ram[l] = 0;
 208   7                                              }
 209   6                                              decoder_temp_to_mcuram(display_ram, temp_buff); //Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×é 8×
             -Ö½Ú×ª6×Ö½Ú
 210   6                                              tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 211   6                                              display();//ÏÔÊ¾ÊýÂë¹Ü
 212   6                                      }
 213   5                                      else if (Two_Menu_F3_E1_temp == 2)//ÎªÑ­»·Ä£Ê½
 214   5                                      {
 215   6                                              for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 216   6                                              {
 217   7                                                      if (display_ram[k * 6] == 0)//ÕÒ³öÎ»ÓÚ¶ÓÁÐ×îºóµÄÄÇ¸öµã
 218   7                                                      {
 219   8                                                              decoder_temp_to_mcuram(display_ram + k * 6, temp_buff);//Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ
             -´æÊý×é 8×Ö½Ú×ª6×Ö½Ú
 220   8                                                              tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 221   8                                                              display();//ÏÔÊ¾ÊýÂë¹Ü
 222   8                                                              break;
 223   8                                                      }
 224   7                                              }
 225   6      
 226   6                                      }
 227   5                                      //clear_again_receive_rf_decoder_finished();//Çå³ý½âÂëÍê³É±êÖ¾Î»
 228   5                                      break;
 229   5                              }
 230   4                              //ºô½ÐÆ÷×¢²á,ËÑË÷ËùÐèÒªµÄºô½ÐÆ÷
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 5   

 231   4                              for (j = 0; j<CALL_TABLE_NUMBER + ALARM_TABLE_NUMBER + CANCEL_TABLE_NUMBER; j++)//ËÑË÷±êÖ¾Î»
 232   4                              {
 233   5                                      IRcvStr(I2C_ADDRESS, j*PAGE_LENGTH, temp_buff1, PAGE_LENGTH);//¶Á³ö32¸ö×Ö½Ú±êÖ¾Î»
 234   5                                      delay10ms();
 235   5                                      for (i = 0; i<PAGE_LENGTH; i++)
 236   5                                      {
 237   6                                              if (temp_buff1[i] == 0)//¶Ô¶Á³öµÄ32×Ö½Ú±êÖ¾Î»½øÐÐ²é¿´£¬¿´ÊÇ·ñÎª0
 238   6                                              {
 239   7                                                      IRcvStr(I2C_ADDRESS, CALL_DATA_START + (j * 32 + i) * 8, temp_buff, 8);//¶Á³ö¶ÔÓ¦µÄ8¸ö×Ö½ÚµÄÊý¾Ý
 240   7                                                      delay10ms();
 241   7                                                      if (((Two_Menu_F8_E1_temp != 1) && temp_buff[5] == old2_RF_RECE_REG[0] && temp_buff[6] == old2_RF_RE
             -CE_REG[1] && ((temp_buff[7] >> 4) == (old2_RF_RECE_REG[2] >> 4))) || ((Two_Menu_F8_E1_temp == 1) && temp_buff[5] == old2
             -_RF_RECE_REG[0] && temp_buff[6] == old2_RF_RECE_REG[1] && temp_buff[7] == old2_RF_RECE_REG[2]))
 242   7                                                      {
 243   8      #ifdef DEBUG
 244   8                                                              uart_printf("ÄãºÃ \r\n");
 245   8      #endif
 246   8                                                              if (temp_buff[0] < 50)
 247   8                                                              {
 248   9                                                                      if (Two_Menu_F8_E1_temp == 1)  //Îª°´¼üÖµ
 249   9                                                                      {
 250  10      
 251  10                                                                              temp_buff[0] = single_key[old2_RF_RECE_REG[2] & 0x0f];
 252  10                                                                      }
 253   9                                                                      else
 254   9                                                                      {
 255  10      
 256  10                                                                              temp_buff[0] = multiple_key[old2_RF_RECE_REG[2] & 0x0f];
 257  10                                                                      }
 258   9                                                              }
 259   8                              
 260   8                                                              if (Two_Menu_F3_E1_temp == 1)//Îª¼´Ê±Ä£Ê½
 261   8                                                              {
 262   9      
 263   9                                                                      if (temp_buff[0] != QUXIAO_1 && temp_buff[0])
 264   9                                                                      {
 265  10      #ifdef DEBUG
 266  10                                                                              uart_printf("cancen funtion fault \r\n");
 267  10      #endif
 268  10                                                                              submenuf6_1(Two_Menu_F6_E1_temp, temp_buff, temp_buff[0], old2_RF_RECE_REG[2] & 0x0f);
 269  10                                                                      }
 270   9                                                                      else
 271   9                                                                      {
 272  10      #ifdef DEBUG
 273  10                                                                              uart_printf("cancen funtion success \r\n");
 274  10      #endif
 275  10                                                                              Cancel_funtion(temp_buff, display_ram);//È¡Ïûº¯Êý
 276  10                                                                              tm1629_load();
 277  10                                                                              display();
 278  10                                                                              break;
 279  10                                                                              break;
 280  10                                                                      }
 281   9      
 282   9                                                                      for (l = Two_Menu_F3_E2_temp; l>1; l--) //ÕûÌåÍùÏÂÒÆÒ»×éÊý¾Ý
 283   9                                                                      {
 284  10                                                                              mcuram_to_mcuram_down(display_ram + (l - 2) * 6);
 285  10                                                                      }
 286   9                                                                      for (l = 0; l<6; l++)//½²µÚÒ»×éÊý¾ÝÇå0
 287   9                                                                      {
 288  10                                                                              display_ram[l] = 0;
 289  10                                                                      }
 290   9                                                                      decoder_temp_to_mcuram(display_ram, temp_buff);//Èç¹û·ûºÏµÄ»°  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×é 
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 6   

             -8×Ö½Ú×ª6×Ö½Ú
 291   9                                                                      tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 292   9                                                                      display();//ÏÔÊ¾ÊýÂë¹Ü
 293   9                                                              }
 294   8                                                      else if (Two_Menu_F3_E1_temp == 2)//ÎªÑ­»·Ä£Ê½
 295   8                                                      {
 296   9                                                              for (k = 0; k < Two_Menu_F3_E2_temp; k++)
 297   9                                                              {
 298  10                                                                      if (display_ram[k * 6 ] == 0)//ÕÒ³öÎ»ÓÚ¶ÓÁÐ×îºóµÄÄÇ¸öµã
 299  10                                                                      {
 300  11                                                                              decoder_temp_to_mcuram(display_ram + k * 6, temp_buff);//  ½«ÁÙÊ±Êý×éµÄÊý¾ÝÒÆÈëµ¥Æ¬»úÔÝ´æÊý×é 8×Ö
             -½Ú×ª6×Ö½Ú
 301  11                                                                              tm1629_load();//µ¥Æ¬»ú°ÑÊý×éÄÚÈÝÔØÈëÊýÂë¹ÜÏÔ´æÊý×éÖÐ
 302  11                                                                              display();//ÏÔÊ¾ÊýÂë¹Ü
 303  11                                                                              break;
 304  11                                                                      }
 305  10                                                              }
 306   9                                                      }
 307   8      #ifdef DEBUG
 308   8                                                              uart_printf("decoder success!");
 309   8      #endif
 310   8      
 311   8      #ifdef DEBUG
 312   8                                                              uart_printf("display_ram is %02x %02x %02x %02x.\r\n", (unsigned int)display_ram[0], (unsigned int)
             -display_ram[1], (unsigned int)display_ram[2], (unsigned int)display_ram[3]); //²âÊÔ°´¼ü¼üÖµ
 313   8      #endif
 314   8                                                              clear_again_receive_rf_decoder_finished();
 315   8                                                              break;
 316   8                                                              break;
 317   8                                                      }
 318   7                                              }
 319   6                                      }
 320   5                              }
 321   4                              break;
 322   4                      }
 323   3      
 324   3                      case TWO_MENU_F1_E1_D1:
 325   3                      case TWO_MENU_F1_E1_D2:
 326   3                      case TWO_MENU_F1_E1_D3:
 327   3                      case TWO_MENU_F1_E1_D4:
 328   3                      {
 329   4                              set_func_index(TWO_MENU_F1_E1_D4);
 330   4                              buf_eeprom[0] = old2_RF_RECE_REG[2] & 0x0f;//°´¼üÖµ±£´æµ½0×Ö½Ú
 331   4                              buf_eeprom[1] = Two_Menu_F1_E1[0];/*ÊýÖµ´æÈë1 2 3 4×Ö½Ú*/
 332   4                              buf_eeprom[2] = Two_Menu_F1_E1[1];
 333   4                              buf_eeprom[3] = Two_Menu_F1_E1[2];
 334   4                              buf_eeprom[4] = Two_Menu_F1_E1[3];
 335   4                              buf_eeprom[5] = old2_RF_RECE_REG[0];// IDÂë´æÈë 5 6 7 ×Ö½Ú
 336   4                              buf_eeprom[6] = old2_RF_RECE_REG[1];
 337   4                              if (Two_Menu_F8_E1_temp == 1)
 338   4                              {
 339   5                                      buf_eeprom[7] = old2_RF_RECE_REG[2];
 340   5                              }
 341   4                              else
 342   4                              {
 343   5                                      buf_eeprom[7] = old2_RF_RECE_REG[2] & 0xf0;
 344   5                              }
 345   4      
 346   4                              if (register_call_function(buf_eeprom))//ÊýÖµ×Ô¶¯¼Ó1
 347   4                              {
 348   5      #ifdef DEBUG
 349   5                                      uart_printf("call is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6], 
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 7   

             -(unsigned int)buf_eeprom[7]); //²âÊÔ°´¼ü¼üÖµ
 350   5                                      uart_printf("call is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E1[0], (unsigned int)Two_Men
             -u_F1_E1[1], (unsigned int)Two_Menu_F1_E1[2], (unsigned int)Two_Menu_F1_E1[3]);
 351   5                                      uart_printf("caller is rigister success \r\n");
 352   5      #endif                                  
 353   5                                      delay10ms();
 354   5                                      if (Two_Menu_F1_E1[3] == 9)
 355   5                                      {
 356   6                                              if (Two_Menu_F1_E1[2] == 9)
 357   6                                              {
 358   7                                                      if (Two_Menu_F1_E1[1] == 9)
 359   7                                                      {
 360   8                                                              Two_Menu_F1_E1[0]++;
 361   8                                                              Two_Menu_F1_E1[1] = 0;
 362   8                                                              Two_Menu_F1_E1[2] = 0;
 363   8                                                              if (Two_Menu_F1_E1[0] == 21)
 364   8                                                              {
 365   9                                                                      Two_Menu_F1_E1[0] = 0;
 366   9                                                                      Two_Menu_F1_E1[3] = 1;
 367   9                                                              }
 368   8                                                              else
 369   8                                                              {
 370   9                                                                      Two_Menu_F1_E1[3] = 1;
 371   9                                                              }
 372   8                                                      }
 373   7                                                      else
 374   7                                                      {
 375   8                                                              Two_Menu_F1_E1[1]++;
 376   8                                                              Two_Menu_F1_E1[2] = 0;
 377   8                                                              Two_Menu_F1_E1[3] = 0;
 378   8                                                      }
 379   7                                              }
 380   6                                              else
 381   6                                              {
 382   7                                                      Two_Menu_F1_E1[2]++;
 383   7                                                      Two_Menu_F1_E1[3] = 0;
 384   7                                              }
 385   6                                      }
 386   5                                      else
 387   5                                              Two_Menu_F1_E1[3]++;
 388   5                              }
 389   4                              break;
 390   4                      }
 391   3      
 392   3                      case TWO_MENU_F1_E2_D1:
 393   3                      case TWO_MENU_F1_E2_D2:
 394   3                      case TWO_MENU_F1_E2_D3:
 395   3                      case TWO_MENU_F1_E2_D4:
 396   3                      {
 397   4                                                                        set_func_index(TWO_MENU_F1_E2_D4);
 398   4                                                                        buf_eeprom[0] = old2_RF_RECE_REG[2] & 0x0f;//°´¼üÖµ±£´æµ½0×Ö½Ú
 399   4                                                                        buf_eeprom[1] = Two_Menu_F1_E2[0];/*ÊýÖµ´æÈë1 2 3 4×Ö½Ú*/
 400   4                                                                        buf_eeprom[2] = Two_Menu_F1_E2[1];
 401   4                                                                        buf_eeprom[3] = Two_Menu_F1_E2[2];
 402   4                                                                        buf_eeprom[4] = Two_Menu_F1_E2[3];
 403   4                                                                        buf_eeprom[5] = old2_RF_RECE_REG[0];// IDÂë´æÈë 5 6 7 ×Ö½Ú
 404   4                                                                        buf_eeprom[6] = old2_RF_RECE_REG[1];
 405   4                                                                        buf_eeprom[7] = old2_RF_RECE_REG[2] & 0xf0;
 406   4      
 407   4                                                                        if (register_host_function(buf_eeprom))//ÊýÖµ×Ô¶¯¼Ó1
 408   4                                                                        {
 409   5      #ifdef DEBUG
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 8   

 410   5                                                                                uart_printf("host is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eepr
             -om[6], (unsigned int)buf_eeprom[7]); //²âÊÔ°´¼ü¼üÖµ
 411   5                                                                                uart_printf("host is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E2[0], (unsigned int)
             -Two_Menu_F1_E2[1], (unsigned int)Two_Menu_F1_E2[2], (unsigned int)Two_Menu_F1_E2[3]);
 412   5                                                                                uart_printf("host is rigister success \r\n");
 413   5      #endif                                  
 414   5                                                                                delay10ms();
 415   5                                                                                if (Two_Menu_F1_E2[3] == 9)
 416   5                                                                                {
 417   6                                                                                        if (Two_Menu_F1_E2[2] == 9)
 418   6                                                                                        {
 419   7                                                                                                if (Two_Menu_F1_E2[1] == 9)
 420   7                                                                                                {
 421   8                                                                                                        Two_Menu_F1_E2[0]++;
 422   8                                                                                                        Two_Menu_F1_E2[1] = 0;
 423   8                                                                                                        Two_Menu_F1_E2[2] = 0;
 424   8                                                                                                        if (Two_Menu_F1_E2[0] == 21)
 425   8                                                                                                        {
 426   9                                                                                                                Two_Menu_F1_E2[0] = 0;
 427   9                                                                                                                Two_Menu_F1_E2[3] = 1;
 428   9                                                                                                        }
 429   8                                                                                                        else
 430   8                                                                                                        {
 431   9                                                                                                                Two_Menu_F1_E2[3] = 1;
 432   9                                                                                                        }
 433   8      
 434   8      
 435   8                                                                                                }
 436   7                                                                                                else
 437   7                                                                                                {
 438   8                                                                                                        Two_Menu_F1_E2[1]++;
 439   8                                                                                                        Two_Menu_F1_E2[2] = 0;
 440   8                                                                                                        Two_Menu_F1_E2[3] = 0;
 441   8                                                                                                }
 442   7                                                                                        }
 443   6                                                                                        else
 444   6                                                                                        {
 445   7                                                                                                Two_Menu_F1_E2[2]++;
 446   7                                                                                                Two_Menu_F1_E2[3] = 0;
 447   7                                                                                        }
 448   6                                                                                }
 449   5                                                                                else
 450   5                                                                                        Two_Menu_F1_E2[3]++;
 451   5                                                                        }
 452   4                                                                        break;
 453   4                      }
 454   3      
 455   3                      case TWO_MENU_F1_E3_D1:
 456   3                      case TWO_MENU_F1_E3_D2:
 457   3                      case TWO_MENU_F1_E3_D3:
 458   3                      case TWO_MENU_F1_E3_D4:
 459   3                      {
 460   4                              set_func_index(TWO_MENU_F1_E3_D4);
 461   4                              buf_eeprom[0] = BAOJING_1;//°´¼üÖµ±£´æµ½0×Ö½Ú
 462   4                              buf_eeprom[1] = Two_Menu_F1_E3[0];/*ÊýÖµ´æÈë1 2 3 4×Ö½Ú*/
 463   4                              buf_eeprom[2] = Two_Menu_F1_E3[1];
 464   4                              buf_eeprom[3] = Two_Menu_F1_E3[2];
 465   4                              buf_eeprom[4] = Two_Menu_F1_E3[3];
 466   4                              buf_eeprom[5] = old2_RF_RECE_REG[0];// IDÂë´æÈë 5 6 7 ×Ö½Ú
 467   4                              buf_eeprom[6] = old2_RF_RECE_REG[1];
 468   4                              buf_eeprom[7] = old2_RF_RECE_REG[2] & 0xf0;
 469   4      
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 9   

 470   4                              if (register_alarm_function(buf_eeprom))//ÊýÖµ×Ô¶¯¼Ó1
 471   4                              {
 472   5      #ifdef DEBUG
 473   5                                      uart_printf("alarm is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6],
             - (unsigned int)buf_eeprom[7]); //²âÊÔ°´¼ü¼üÖµ
 474   5                                      uart_printf("alarm is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E3[0], (unsigned int)Two_Me
             -nu_F1_E3[1], (unsigned int)Two_Menu_F1_E3[2], (unsigned int)Two_Menu_F1_E3[3]);
 475   5                                      uart_printf("alarm is rigister success \r\n");
 476   5      #endif                                  
 477   5                                      delay10ms();
 478   5                                      if (Two_Menu_F1_E3[3] == 9)
 479   5                                      {
 480   6                                              if (Two_Menu_F1_E3[2] == 9)
 481   6                                              {
 482   7                                                      if (Two_Menu_F1_E3[1] == 9)
 483   7                                                      {
 484   8                                                              Two_Menu_F1_E3[0]++;
 485   8                                                              Two_Menu_F1_E3[1] = 0;
 486   8                                                              Two_Menu_F1_E3[2] = 0;
 487   8                                                              if (Two_Menu_F1_E3[0] == 21)
 488   8                                                              {
 489   9                                                                      Two_Menu_F1_E3[0] = 0;
 490   9                                                                      Two_Menu_F1_E3[3] = 1;
 491   9                                                              }
 492   8                                                              else
 493   8                                                              {
 494   9                                                                      Two_Menu_F1_E3[3] = 1;
 495   9                                                              }
 496   8                                                      }
 497   7                                                      else
 498   7                                                      {
 499   8                                                              Two_Menu_F1_E3[1]++;
 500   8                                                              Two_Menu_F1_E3[2] = 0;
 501   8                                                              Two_Menu_F1_E3[3] = 0;
 502   8                                                      }
 503   7                                              }
 504   6                                              else
 505   6                                              {
 506   7                                                      Two_Menu_F1_E3[2]++;
 507   7                                                      Two_Menu_F1_E3[3] = 0;
 508   7                                              }
 509   6                                      }
 510   5                                      else
 511   5                                              Two_Menu_F1_E3[3]++;
 512   5                              }
 513   4                              break;
 514   4                      }
 515   3                      case TWO_MENU_F1_E4_D1:
 516   3                      case TWO_MENU_F1_E4_D2:
 517   3                      case TWO_MENU_F1_E4_D3:
 518   3                      case TWO_MENU_F1_E4_D4:
 519   3                      {
 520   4                              set_func_index(TWO_MENU_F1_E4_D4);
 521   4                              buf_eeprom[0] = QUXIAO_1;//°´¼üÖµ±£´æµ½0×Ö½Ú
 522   4                              buf_eeprom[1] = Two_Menu_F1_E4[0];/*ÊýÖµ´æÈë1 2 3 4×Ö½Ú*/
 523   4                              buf_eeprom[2] = Two_Menu_F1_E4[1];
 524   4                              buf_eeprom[3] = Two_Menu_F1_E4[2];
 525   4                              buf_eeprom[4] = Two_Menu_F1_E4[3];
 526   4                              buf_eeprom[5] = old2_RF_RECE_REG[0];// IDÂë´æÈë 5 6 7 ×Ö½Ú
 527   4                              buf_eeprom[6] = old2_RF_RECE_REG[1];
 528   4                              buf_eeprom[7] = old2_RF_RECE_REG[2] & 0xf0;
 529   4      
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 10  

 530   4                              if (register_cancel_function(buf_eeprom))//ÊýÖµ×Ô¶¯¼Ó1
 531   4                              {
 532   5      #ifdef DEBUG
 533   5                                      uart_printf("cancel is %02x %02x %02x .\r\n", (unsigned int)buf_eeprom[5], (unsigned int)buf_eeprom[6]
             -, (unsigned int)buf_eeprom[7]); //²âÊÔ°´¼ü¼üÖµ
 534   5                                      uart_printf("cancel is %02x %02x %02x %02x.\r\n", (unsigned int)Two_Menu_F1_E4[0], (unsigned int)Two_M
             -enu_F1_E4[1], (unsigned int)Two_Menu_F1_E4[2], (unsigned int)Two_Menu_F1_E4[3]);
 535   5                                      uart_printf("cancel is rigister success \r\n");
 536   5      #endif                                  
 537   5                                      delay10ms();
 538   5                                      if (Two_Menu_F1_E4[3] == 9)
 539   5                                      {
 540   6                                              if (Two_Menu_F1_E4[2] == 9)
 541   6                                              {
 542   7                                                      if (Two_Menu_F1_E4[1] == 9)
 543   7                                                      {
 544   8                                                              Two_Menu_F1_E4[0]++;
 545   8                                                              Two_Menu_F1_E4[1] = 0;
 546   8                                                              Two_Menu_F1_E4[2] = 0;
 547   8                                                              if (Two_Menu_F1_E4[0] == 21)
 548   8                                                              {
 549   9                                                                      Two_Menu_F1_E4[0] = 0;
 550   9                                                                      Two_Menu_F1_E4[3] = 1;
 551   9                                                              }
 552   8                                                              else
 553   8                                                              {
 554   9                                                                      Two_Menu_F1_E4[3] = 1;
 555   9                                                              }
 556   8                                                      }
 557   7                                                      else
 558   7                                                      {
 559   8                                                              Two_Menu_F1_E4[1]++;
 560   8                                                              Two_Menu_F1_E4[2] = 0;
 561   8                                                              Two_Menu_F1_E4[3] = 0;
 562   8                                                      }
 563   7                                              }
 564   6                                              else
 565   6                                              {
 566   7                                                      Two_Menu_F1_E4[2]++;
 567   7                                                      Two_Menu_F1_E4[3] = 0;
 568   7                                              }
 569   6                                      }
 570   5                                      else
 571   5                                              Two_Menu_F1_E4[3]++;
 572   5                              }
 573   4                              break;
 574   4                      }
 575   3                      case TWO_MENU_F8_E2_SET :
 576   3      
 577   3                              if (Two_Menu_F8_E1_temp == 1)
 578   3                              {
 579   4                                      single_key[old2_RF_RECE_REG[2] & 0x0f] = Two_Menu_F8_E2_temp;
 580   4                              }
 581   3                              else
 582   3                              {
 583   4                                      multiple_key[old2_RF_RECE_REG[2] & 0x0f] = Two_Menu_F8_E2_temp;
 584   4                              }
 585   3      #ifdef DEBUG
 586   3                              uart_printf("single_key£º  ");
 587   3                              for (i = 0; i < 16; i++)
 588   3                              {
 589   4                                      
C51 COMPILER V9.00   DECODER                                                               10/05/2015 17:39:49 PAGE 11  

 590   4                                      uart_printf("%02d ", (unsigned int)single_key[i]);
 591   4                              }
 592   3                              uart_printf(" \r\n");
 593   3      
 594   3                              uart_printf("multiple_key£º");
 595   3                              for (i = 0; i < 16; i++)
 596   3                              {
 597   4      
 598   4                                      uart_printf("%2d ", (unsigned int)multiple_key[i]);
 599   4                              }
 600   3                              uart_printf(" \r\n");
 601   3      #endif  
 602   3      
 603   3                              break;
 604   3      
 605   3      
 606   3                      default:break;//Ä¬ÈÏµÄbreak
 607   3                      }
 608   2                      clear_again_receive_rf_decoder_finished();//Çå³ý±êÖ¾Î»
 609   2              }
 610   1              
 611   1              LogoutProcess();
 612   1              CycleProcess();
 613   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3540    ----
   CONSTANT SIZE    =    727    ----
   XDATA SIZE       =      8      52
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
