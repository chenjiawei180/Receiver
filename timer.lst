C51 COMPILER V9.00   TIMER                                                                 09/04/2015 10:18:59 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN timer.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Receiver\timer.c LARGE BROWSE INCDIR(.\Receiver) DEBUG OBJECTEXTEND PRINT(.
                    -\timer.lst) TABS(2) OBJECT(timer.obj)

line level    source

   1          #include "timer.h"
   2          #include "key.h"
   3          #include "menu.h"
   4          
   5          unsigned char await_number = 0;      //待机时刻计算50MS次数变量
   6          unsigned char await_number_table = 0;//0.5秒标志变量
   7          
   8          void Init_Timer0(void)
   9          {
  10   1        TMOD |= 0x01;   //使用模式1，16位定时器，使用"|"符号可以在使用多个定时器时不受影响  
  11   1        TH0 = (65536 - TIMER50MS) >> 8; //重新赋值 5ms
  12   1        TL0 = (65536 - TIMER50MS) & 0xff;
  13   1        EA = 1;            //总中断打开
  14   1        ET0 = 1;           //定时器中断打开
  15   1        TR0 = 1;           //定时器开关打开
  16   1      }
  17          
  18          void Timer0_isr(void) interrupt 1
  19          {
  20   1        unsigned char func_index_temp = 0;
  21   1        TF0 = 0;
  22   1        TH0 = (65536 - TIMER50MS) >> 8;     //重新赋值 50ms
  23   1        TL0 = (65536 - TIMER50MS) & 0xff;
  24   1        func_index_temp = return_func_index();
  25   1        if (func_index_temp == MENU_STANDBY)
  26   1        {
  27   2          await_number++;
  28   2          if (await_number == 10)
  29   2          {
  30   3            await_number_table++;
  31   3            await_number = 0;
  32   3          }
  33   2        }
  34   1      
  35   1      }
  36          
  37          unsigned char return_await_number_table(void) //返回await_number_table变量的值
  38          {
  39   1        unsigned char await_number_table_temp=0;
  40   1        await_number_table_temp = await_number_table;
  41   1        return await_number_table_temp;
  42   1      }
  43          
  44          void set_await_number_table(unsigned char temp) //设置await_number_table变量的值
  45          {
  46   1        await_number_table = temp;
  47   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    119    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      2    ----
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.00   TIMER                                                                 09/04/2015 10:18:59 PAGE 2   

   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
